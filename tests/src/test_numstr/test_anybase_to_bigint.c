#include "tests.h"

bigint *output = NULL;

/**
 * setup - setup some variables.
 */
void setup(void) {}

/**
 * teardown - cleanup after tests.
 */
void teardown(void)
{
	output = bi_delete(output);
}

TestSuite(null_inputs);

Test(null_inputs, test_NULL, .description = "NULL", .timeout = 1.0)
{
	cr_assert(zero(ptr, anybase_to_bni(NULL, 10)));
}

Test(null_inputs, test_null_str, .description = "null string", .timeout = 1.0)
{
	numstr in = {.len = 1, .is_negative = false, .str = NULL};

	cr_assert(zero(ptr, anybase_to_bni(&in, 2)));
}

TestSuite(long_51bit_number, .init = setup, .fini = teardown);

Test(long_51bit_number, test_1234567007654321_from_base2,
	 .description = "100011000101101010100000111111100010101000110110001",
	 .timeout = 1.0)
{
	numstr in = {
		.len = 51,
		.is_negative = false,
		.str = "100011000101101010100000111111100010101000110110001"};
	u_int arr[] = {7654321, 1234567};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 2);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(long_51bit_number, test_1234567007654321_from_base8,
	 .description = "43055240774250661", .timeout = 1.0)
{
	numstr in = {.len = 17, .is_negative = false, .str = "43055240774250661"};
	u_int arr[] = {7654321, 1234567};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 8);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(long_51bit_number, test_1234567007654321_from_base10,
	 .description = "1234567007654321", .timeout = 1.0)
{
	numstr in = {.len = 16, .is_negative = false, .str = "1234567007654321"};
	u_int arr[] = {7654321, 1234567};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 10);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(long_51bit_number, test_1234567007654321_from_base16,
	 .description = "462D507F151B1", .timeout = 1.0)
{
	numstr in = {.len = 13, .is_negative = false, .str = "462D507F151B1"};
	u_int arr[] = {7654321, 1234567};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 16);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(long_51bit_number, test_1234567007654321_from_base36,
	 .description = "C5M894S59T", .timeout = 1.0)
{
	numstr in = {.len = 10, .is_negative = false, .str = "C5M894S59T"};
	u_int arr[] = {7654321, 1234567};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 36);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

TestSuite(large_10210bit_number, .init = setup, .fini = teardown);

// Test(large_10210bit_number, test_o1ka_from_base2,
// 	 .description = "o_1k.a", .timeout = 1.0)
// {
// 	char *s = "1000111000100110111100001100111110110110011101100011111010110001101000111111010100100011011100100000101010000011110010110111110111000001101110110010101101111001111000011100011010110000010000110001100011001011100110001101001110111000010100101101000011001111001101000001100001000101100100101101100101100001001010011011100111010000011111111100001100111100111111001011010001000101110010010100110100011101010011111111101000101001110100110111001111101001100011111101011001010100110000000110101101111111110011101011111001010000101010011000010000011101000010111101011010011010100110010111011001011101111100001011011111000001101011010100111101001011110001110101100100110001010101000011000010010100010000001100000010111110011110111010010011001011011011110110011010001010100101101000011011101111001010011111001101111101111110110101100010010010001111001110010111111100011100010110010001000100000010000110101010110111100011110000111111001000101010010001011001010111100011101011110111110100000101001010000001011001010000100010000110101011001110001000011110011100000011111010110110100000111101111101101110010110010010110110011111101111110101010011000010011110100111010010111011001100011111100000101101011110001000101111111101101001111110000000010101011111111010001111110100100101010011111110011111101101111101001011110000110010110110011101010010111000010100100111000001010001100101101011010110100111101100000011000101010010110000100111011001010001100100100100011100100000111100010100010010011010101110000000010000000000010010011011000011011110111000011000111101110111101000001110000001011010010111011100100010000010101010011111000010011111001000100110001001011010110100110110111010010000110111001101011101100010010000110101100010111001011110000110000101110111011101111101011111010011110000001000101001110101001110011100111011111101010001010010101101110011000001100000010010100000000111010100011011110100100000111110101011111100101000110000110001000111110001000000001011101001010100011000000010010011011011101110000111101100011111011110000101101001101110010100000001011001110001101111111101000000101110010101100011111110001011101101010011111110001111010110011010101111011011101110101001000100100001001010110011101111110110011111011001001110101111111010111010100010000010001100000001101110101110110010010101110101001010110110000001001010000111100110001010110100010100000110000101001000001111011101101101101011111110100111001000101111101101011110011001111000001001011011111110101010100010011101111100011101000110000001111111100110101101100100011100011001100000010001010101000110000110000011111011000100111110100101100110011100100011011011001110110110000010010001110010000000110001010011001010001010111001101000000001101001110000001001110000101000001010101000000110101000101011111110100010111001000111010011111010101101010011101101011111100000100010011101011001111100011100111101100111111001010010010010000010111111011100100100011111100101100001001110010010000110110001011011111110100100001101001101111110110110000010111100110111101110001111111101101110010101101000011110100011111101111010100011110000001110110110001010011000111110000111101010111101000010110101100001000001110101011100111010110000010010010000111010000101010011110111011101000001101110101111111110000110110100011001101010010001110000110010101110000011010111100011001110000001100001011000001100101010110101010101001111110101110101001101110011110001010011001001111000000111111010111010111000001001111010000011011001100001000010111011110111110001000100010010001111001010010111001000111101100111110001000110011101101011001111001101111000101101111000001010010010110011010100010111010000011000111000001011100101000010110101001100011000101111111000010100010111010011001111011011110101001010111001111101011101001010100100010010000010001001101000111111010001000001101111110001011010101110100011001100011000000000110100011101000111100100111111110100000000001111111110010110101100111100110011111010000110100001000101100001010100011100001101010101110111110111110111111000011101110110011101111010111001110110101111001100011010000000100111001010100100011101000010101010111110010111110100010101011010010000011111000110110110010001000100000110111111000001000011100101001100010001010001011111111010000001110110011110101000010000001100110110110100011101100100010101111011011001000111101111000111111001010100001010111010010010010000001110111110100001000110100100110011111101000110011000101010010010110111000011000011110011110011100101101000110001110101101010101110011111000011010001011001000111100100010100101010110010110101010110110010110011100010101110100100001010111101011100110100101100000011101001101001110111010011111010011010111001110111011011110011110001101101011110111111101111000101001110111111001001010101010001101101110000111010010010011011101101001111010010011011011001100110100001001011010110100001111001101001000011111111000010100000101100010101011110010110101000001011110111000101110110110011010110111101100001000110010110111001110101000000100001000110011000001000001010010011110010110001101100111000000010001011000000111101101001101011101110010011011100011111110011001111010000000100110111100101101100100011111110010011011010100101010001000010111010010110101110011011001001100011000001111001101001111111110111110110010100100110101000011011101001011101110011001101101001000111110010111000110111011001011100010000101010011101100011001001101100001000000000010110111100110100101110010000111000110010001010001010000110001111101111111001111001011001010101110011010111100111100011101000010000001101110001001101101110010010100010001101001110110001100010001110000100111001010011010010000000101000010111101001111000110001110001100100001000001000000000000001010000111110100100010101010110110000010111111010101111011100010111000110111010100000000110101000010011010011010010010001101111100010000101101111011100001100010111001001001111110100001010000011011111011101110001010000100100000100100011111100000101111100000110111111010111001111001011100100011011011011101111001011111110111000110101111101011100100111100000001000011000111001000110011010000010110010011110001011111110101011001111110011101100010101110100111100000001101110100011101111110001001001110100101110001101110010111101001101110101100111110100001011100110010101011110011001010010000000111010100000110010111101111101110010011000111110011010000000111100110101111111101010001000011000100110011100101001111001111111010001001010110001111000111001111010001110010110001011100100011011100100010010010010101010100100010101110000111011100110011101110110101000001000010111100111000100011100100111101000010111010000010101100011011110011101111000011011001011101001101101001011001000101010011100101100001001011011110010101010101100110001000001101011001101100100010100111110010001000010100011111111101000100101100000101110111111010010001110010010111111101100010011000111011000100101100111010011110010011100110110011010111101110111101011010100010110001101011011011010011110011101011001001010000101001111000100110101111010111010011011011110110011010010101000101000100101001101100110100001001100101011101100100100101000101100100101101000111100111111000001001000010000101110100101101101110110010000100101100010111101001001000101101100111011110100100001011001001001010110001100111011110011011000100001101001100111011111110111011010000011000100011111100001100101100011110110001101111011001011000011101101000110011100111000000111110001110000111011111111100010000110101011110010110100100101110010000010010101011110111000111000001010100111111010011000110000001111100101010000010110100101110010101101111001101010010001101001001101111101011100111001111001110010110011000111110101100010100100010010010100111101010110001110101101001111101111100110101101010111011011001101010100101000000111101010111001010101011000000011101110100100001100001010011101010001010110010010001000110011000100001011011111010111111011110101111001010001100000000010010101011001101111001000010100101010010010001000001100110111100101111110110000101001001101010101011011010110000100111101011001010000110001001011000111101010011001011010101110001000101011011001111011000110011011101010011011100110001101101001000010001011011011100011110011100001010111100001101110001000010100011011001010110001110100001110000101001000011001110110100001000000011011101101100011000010101011101000010010001100010111000111110101101000100100001010001101100101010111110110001010101100001101010111110101110000011000010111111010000111001001101110001101001000101011101110000011100001101000101100011101101100100101000001010001111101101111101000010100100011001110111110111101011010111011101001010101000011010000001100110000111111000011011010010000001000110100111110101110110110110001100110001001110010101011111001100000101100001010110111010011100000111000010001011110101100001001101010010101100010111101011011010001101000100000011111000010100011100100110101001100100101011011010001101000110010010010111010110000001101111001010001000111110110100111000001010100000010011001110001010101010011001011100110000110110110011100111110011101010000100110010111001110011111000010000011001111010010011110011011101011100010001111100101010101011010000000010100111110011011011011010100011000110001111111000111111000110110111101100111010111000001001111100001001110100111111011100100110000001101111100100000010001111110010101000101000011001110011000000011001110010101010011100101001100010101010011000101110110000001110000101010011111000100010101001000010101101111010101001011111001010010110001100001110011111101111101110001110000101010110010001101100110011010111101011010011001000000110101100010001101001110011010110100101011101110000111111000101011011011110011010000001011011010100101100100010101100011011101011110100101011001110100100101111111100111101000000110011000010111010001010100111100011000000000100111011111110111110101010001100000010011001100000100100101110100000110011010011111011100000011001100101011000101001000011001100100111110101011010100100011000101110010000000100011111101111110110100000010011001010110001001011000100100010011110001000101001101110010011101010110111011101011110000111100101111111010001111010111001011100100010110111010010101001100000001101000100100000010101001100000001100100111001100";
// 	uint arr[] = {645836236, 108893430, 836208119, 270771001, 537613755, 373039867, 833294108, 898839418, 608485063, 546188873, 452231917, 687296422, 111111152, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 476411111, 5669047, 700035645, 893473278, 4493, 543630640, 324000, 568376700, 1394, 300000000, 378345892, 8, 734194700, 423768, 0, 445197384, 518101037, 109617878, 558156514, 983336821, 690076644, 693516675, 143226629, 76588580, 210759419, 973911560, 497333540, 14322213, 555048869, 815323758, 539167661, 458688023, 612425259, 624332483, 419554373, 679371075, 393235000, 236728315, 664373133, 150410609, 518660305, 359239326, 307363945, 571210805, 347785534, 563445710, 660409386, 228008317, 804462179, 233074148, 591937180, 160409198, 950235053, 962974549, 171857157, 523072994, 395079814, 321058488, 203652900, 126072395, 363107953, 630915068, 973080517, 612433363, 734409773, 377726669, 707225937, 627074076, 918808553, 941285428, 110569912, 430944738, 394600177, 990968620, 4498198, 265970467, 594659210, 881718792, 749254660, 489225907, 417635079, 182995180, 494838468, 16834009, 911110449, 948701330, 831191398, 792151714, 70940218, 627665839, 410612359, 202045867, 935804051, 937850141, 227018012, 991791152, 506752363, 406483698, 355792683, 47491630, 22359011, 919962818, 955165934, 399211808, 673319428, 319818160, 662785141, 175882430, 630322415, 735383534, 687650610, 46582669, 496678148, 491637987, 871575195, 116330034, 723314187, 385420689, 325094262, 12829142, 208703866, 120005690, 899921757, 77002169, 359486189, 753454258, 278911354, 694037307, 578519296, 494600786, 470779501, 768446187, 472669563, 716361937, 389127515, 976446119, 593192334, 617083917, 272976737, 418747631, 855714255, 226105187, 605917499, 696971445, 573117854, 99153257, 956645492, 728520292, 946389174, 245482697, 655465609, 470307816, 135416351, 729216591, 866144546, 888959338, 809402688, 527131609, 866613186, 419167460, 916600904, 633154349, 747140489, 315862951, 238759183, 148584074, 652667824, 161606397, 677427537, 590777629, 825244648, 835356427, 366982335, 748040826, 852122159, 4896, 900000000, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 385820199, 167580321, 134092496, 277075937, 872169008, 64325722, 827080282, 277960712, 655352740, 163131699, 448213684, 277128786, 514326330, 933871396, 63154105, 745922799, 490015860, 252229607, 711956623, 591788040, 954758766, 467124003, 644524713, 690634208, 510828673, 629041620, 704066384, 468512842, 590156377, 509105852, 101803594, 777808979, 519622805, 972925209, 333284887, 366099858, 584319133, 851605740, 743738793, 912271659, 205902321, 306768696, 951511006, 853007337, 793747247, 858293618, 953587774, 433638706, 827128463, 10931106, 238240138, 541935268, 774418024, 534563619, 736369239, 336516542, 723202909, 72035747, 712282212, 121201039, 863656439, 738195137, 536402352, 988504044, 143816789, 991215483, 635637328, 796292638, 712577246, 870774981, 572335077, 92461651, 417842402, 465754445, 443219011, 441495263, 360383390, 613384414, 161967625, 730605620, 45166037, 501067481, 119816381, 482382428, 993423658, 444792073, 338718477, 357679842, 186546204, 725908514, 242243363, 998754918, 228221686, 517265463, 874612151, 181719511, 64245869, 179742910, 880842840, 733045974, 909570009, 761337985, 469116507, 501497182, 26189637, 141834727, 777673597, 739280728, 284499268, 848912007, 618450280, 855914917, 508218929, 64124951, 440691829, 852588078, 555626401, 202070759, 783604366, 202777713, 212620403, 857142928, 324004839, 349402718, 847565789, 52519590, 658472794, 842462660, 791141310, 195364150, 381999943, 261729562, 18229};
// 	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
// 	bigint out = {
// 		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

// 	output = anybase_to_bni(&in, 2);
// 	cr_assert(eq(sz, output->len, out.len));
// 	cr_assert(eq(chr, output->is_negative, out.is_negative));
// 	cr_assert(eq(u32[out.len], output->num, out.num));
// }

Test(large_10210bit_number, test_o1ka_from_base8,
	 .description = "o_1k.a", .timeout = 1.0)
{
	char *s = "10704674147666354372615077244334405203626767015662557170343260206143134615167024550317150141054455454112334720377414747713210562246435237750516467175143753124600655776353712052302035027532324627313574133701532475136165446125030224201402763672231333663212455033571237157576654222171627743426210402065267436077105221312743536764051201312042065316103634037266407575562622663757652302364722731437405536105775517600253772176445237637557513606266352270244701214553264754030522604731214444344074242232560020002233033670307567501601322734420252370237104611326466722067153542206542713606056735753723601051651634737521225563014022400724336440765374506061076100135124300223335607543736055156240131615775005625437613552376172632573356510441126357663731165772724202140156566225651266011207461264240605101735555376471057553631701133765242357435060177465544343140212506060373047645463443331666022162006123121271500151601160501250065053764271072372552355374042353174347547712222027734443745411622066133764415157666027467561775562550364375724360166612307607527502654101653472602220720523673501565776066431522160625603274316014130145265251765651563612311700772727011720331410273676104221712271075476106355317157055701222632427203070134502651430577024272317336512717535124422021150772101576132564314300064350744776400177626547463720641054124341525676767703566357271665714320047124435025276276425322037066621040677010345142121377201663650201466643544257331075707712412722220167641064463750630522267030363634550616552563703213107442452626526626342564412753464540351516723723271673363615536775705167711252155607222335517223331464113264171510377024054253626501367056663267541062671650041063010122362615470021300755153562334376317200467455443762332452102722656331143017151776766244650335135631551076270673134205235431154100026746456207062121206175771713125632747435020156115562242151661421604712322005027517061614410100001207644252660277257342706724006502323222157420557341427111764120337356120440443740574067727171344333357137670657534474010307106320262361376531763542564740156435761116456156275156547641346253631220072406275756230763200746577521030463451717721126170717216261344334422225244256073463566501027470434475027202543363570331351551310523454113362525461015315442476210243775045405677221622775423073045472362346632756753242615333236353112051704657272333663225050451546411453544450544550747701102056455566204542751105547364413111261473633041514737673203043741454366157313035506347007616073774206536264456202253670701247723060174520264562557152215115753471716263076542442224752616551757465527331524500752712530035644141235212622106304133727736571214002253157102452221014674576605115253326047531206113075231325610533173063352334615510213334363412741561024331261641605103166410033554302535022142707655044121545276612541527656030277207115615105356034150543554450121755750244316767532735125032014607703322010647656666146116253714054126723407021365411522542753321504037024344651445332150622272601571210766470124023161252313460666347635204627163702031722363353421745253200247633332430617707706675472701174116477344601574402176250503163003162523451425230566016052370425102557251371226141637575616052621546327532310065421516326453560770533363201332454425433536453164457747500630272124743000473767652140231404456406323734031453051031447653244305620043757664023126113044236105156235267353607457721727134426722514015044025140144714";
	u_int arr[] = {645836236, 108893430, 836208119, 270771001, 537613755, 373039867, 833294108, 898839418, 608485063, 546188873, 452231917, 687296422, 111111152, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 476411111, 5669047, 700035645, 893473278, 4493, 543630640, 324000, 568376700, 1394, 300000000, 378345892, 8, 734194700, 423768, 0, 445197384, 518101037, 109617878, 558156514, 983336821, 690076644, 693516675, 143226629, 76588580, 210759419, 973911560, 497333540, 14322213, 555048869, 815323758, 539167661, 458688023, 612425259, 624332483, 419554373, 679371075, 393235000, 236728315, 664373133, 150410609, 518660305, 359239326, 307363945, 571210805, 347785534, 563445710, 660409386, 228008317, 804462179, 233074148, 591937180, 160409198, 950235053, 962974549, 171857157, 523072994, 395079814, 321058488, 203652900, 126072395, 363107953, 630915068, 973080517, 612433363, 734409773, 377726669, 707225937, 627074076, 918808553, 941285428, 110569912, 430944738, 394600177, 990968620, 4498198, 265970467, 594659210, 881718792, 749254660, 489225907, 417635079, 182995180, 494838468, 16834009, 911110449, 948701330, 831191398, 792151714, 70940218, 627665839, 410612359, 202045867, 935804051, 937850141, 227018012, 991791152, 506752363, 406483698, 355792683, 47491630, 22359011, 919962818, 955165934, 399211808, 673319428, 319818160, 662785141, 175882430, 630322415, 735383534, 687650610, 46582669, 496678148, 491637987, 871575195, 116330034, 723314187, 385420689, 325094262, 12829142, 208703866, 120005690, 899921757, 77002169, 359486189, 753454258, 278911354, 694037307, 578519296, 494600786, 470779501, 768446187, 472669563, 716361937, 389127515, 976446119, 593192334, 617083917, 272976737, 418747631, 855714255, 226105187, 605917499, 696971445, 573117854, 99153257, 956645492, 728520292, 946389174, 245482697, 655465609, 470307816, 135416351, 729216591, 866144546, 888959338, 809402688, 527131609, 866613186, 419167460, 916600904, 633154349, 747140489, 315862951, 238759183, 148584074, 652667824, 161606397, 677427537, 590777629, 825244648, 835356427, 366982335, 748040826, 852122159, 4896, 900000000, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 385820199, 167580321, 134092496, 277075937, 872169008, 64325722, 827080282, 277960712, 655352740, 163131699, 448213684, 277128786, 514326330, 933871396, 63154105, 745922799, 490015860, 252229607, 711956623, 591788040, 954758766, 467124003, 644524713, 690634208, 510828673, 629041620, 704066384, 468512842, 590156377, 509105852, 101803594, 777808979, 519622805, 972925209, 333284887, 366099858, 584319133, 851605740, 743738793, 912271659, 205902321, 306768696, 951511006, 853007337, 793747247, 858293618, 953587774, 433638706, 827128463, 10931106, 238240138, 541935268, 774418024, 534563619, 736369239, 336516542, 723202909, 72035747, 712282212, 121201039, 863656439, 738195137, 536402352, 988504044, 143816789, 991215483, 635637328, 796292638, 712577246, 870774981, 572335077, 92461651, 417842402, 465754445, 443219011, 441495263, 360383390, 613384414, 161967625, 730605620, 45166037, 501067481, 119816381, 482382428, 993423658, 444792073, 338718477, 357679842, 186546204, 725908514, 242243363, 998754918, 228221686, 517265463, 874612151, 181719511, 64245869, 179742910, 880842840, 733045974, 909570009, 761337985, 469116507, 501497182, 26189637, 141834727, 777673597, 739280728, 284499268, 848912007, 618450280, 855914917, 508218929, 64124951, 440691829, 852588078, 555626401, 202070759, 783604366, 202777713, 212620403, 857142928, 324004839, 349402718, 847565789, 52519590, 658472794, 842462660, 791141310, 195364150, 381999943, 261729562, 18229};
	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 8);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(large_10210bit_number, test_o1ka_from_base10,
	 .description = "o_1k.a", .timeout = 1.0)
{
	char *s = "18229261729562381999943195364150791141310842462660658472794052519590847565789349402718324004839857142928212620403202777713783604366202070759555626401852588078440691829064124951508218929855914917618450280848912007284499268739280728777673597141834727026189637501497182469116507761337985909570009733045974880842840179742910064245869181719511874612151517265463228221686998754918242243363725908514186546204357679842338718477444792073993423658482382428119816381501067481045166037730605620161967625613384414360383390441495263443219011465754445417842402092461651572335077870774981712577246796292638635637328991215483143816789988504044536402352738195137863656439121201039712282212072035747723202909336516542736369239534563619774418024541935268238240138010931106827128463433638706953587774858293618793747247853007337951511006306768696205902321912271659743738793851605740584319133366099858333284887972925209519622805777808979101803594509105852590156377468512842704066384629041620510828673690634208644524713467124003954758766591788040711956623252229607490015860745922799063154105933871396514326330277128786448213684163131699655352740277960712827080282064325722872169008277075937134092496167580321385820199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999900000000000004896852122159748040826366982335835356427825244648590777629677427537161606397652667824148584074238759183315862951747140489633154349916600904419167460866613186527131609809402688888959338866144546729216591135416351470307816655465609245482697946389174728520292956645492099153257573117854696971445605917499226105187855714255418747631272976737617083917593192334976446119389127515716361937472669563768446187470779501494600786578519296694037307278911354753454258359486189077002169899921757120005690208703866012829142325094262385420689723314187116330034871575195491637987496678148046582669687650610735383534630322415175882430662785141319818160673319428399211808955165934919962818022359011047491630355792683406483698506752363991791152227018012937850141935804051202045867410612359627665839070940218792151714831191398948701330911110449016834009494838468182995180417635079489225907749254660881718792594659210265970467004498198990968620394600177430944738110569912941285428918808553627074076707225937377726669734409773612433363973080517630915068363107953126072395203652900321058488395079814523072994171857157962974549950235053160409198591937180233074148804462179228008317660409386563445710347785534571210805307363945359239326518660305150410609664373133236728315393235000679371075419554373624332483612425259458688023539167661815323758555048869014322213497333540973911560210759419076588580143226629693516675690076644983336821558156514109617878518101037445197384000000000000423768734194700000000008378345892300000000000001394568376700000324000543630640000004493893473278700035645005669047476411111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111152687296422452231917546188873608485063898839418833294108373039867537613755270771001836208119108893430645836236";
	u_int arr[] = {645836236, 108893430, 836208119, 270771001, 537613755, 373039867, 833294108, 898839418, 608485063, 546188873, 452231917, 687296422, 111111152, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 476411111, 5669047, 700035645, 893473278, 4493, 543630640, 324000, 568376700, 1394, 300000000, 378345892, 8, 734194700, 423768, 0, 445197384, 518101037, 109617878, 558156514, 983336821, 690076644, 693516675, 143226629, 76588580, 210759419, 973911560, 497333540, 14322213, 555048869, 815323758, 539167661, 458688023, 612425259, 624332483, 419554373, 679371075, 393235000, 236728315, 664373133, 150410609, 518660305, 359239326, 307363945, 571210805, 347785534, 563445710, 660409386, 228008317, 804462179, 233074148, 591937180, 160409198, 950235053, 962974549, 171857157, 523072994, 395079814, 321058488, 203652900, 126072395, 363107953, 630915068, 973080517, 612433363, 734409773, 377726669, 707225937, 627074076, 918808553, 941285428, 110569912, 430944738, 394600177, 990968620, 4498198, 265970467, 594659210, 881718792, 749254660, 489225907, 417635079, 182995180, 494838468, 16834009, 911110449, 948701330, 831191398, 792151714, 70940218, 627665839, 410612359, 202045867, 935804051, 937850141, 227018012, 991791152, 506752363, 406483698, 355792683, 47491630, 22359011, 919962818, 955165934, 399211808, 673319428, 319818160, 662785141, 175882430, 630322415, 735383534, 687650610, 46582669, 496678148, 491637987, 871575195, 116330034, 723314187, 385420689, 325094262, 12829142, 208703866, 120005690, 899921757, 77002169, 359486189, 753454258, 278911354, 694037307, 578519296, 494600786, 470779501, 768446187, 472669563, 716361937, 389127515, 976446119, 593192334, 617083917, 272976737, 418747631, 855714255, 226105187, 605917499, 696971445, 573117854, 99153257, 956645492, 728520292, 946389174, 245482697, 655465609, 470307816, 135416351, 729216591, 866144546, 888959338, 809402688, 527131609, 866613186, 419167460, 916600904, 633154349, 747140489, 315862951, 238759183, 148584074, 652667824, 161606397, 677427537, 590777629, 825244648, 835356427, 366982335, 748040826, 852122159, 4896, 900000000, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 385820199, 167580321, 134092496, 277075937, 872169008, 64325722, 827080282, 277960712, 655352740, 163131699, 448213684, 277128786, 514326330, 933871396, 63154105, 745922799, 490015860, 252229607, 711956623, 591788040, 954758766, 467124003, 644524713, 690634208, 510828673, 629041620, 704066384, 468512842, 590156377, 509105852, 101803594, 777808979, 519622805, 972925209, 333284887, 366099858, 584319133, 851605740, 743738793, 912271659, 205902321, 306768696, 951511006, 853007337, 793747247, 858293618, 953587774, 433638706, 827128463, 10931106, 238240138, 541935268, 774418024, 534563619, 736369239, 336516542, 723202909, 72035747, 712282212, 121201039, 863656439, 738195137, 536402352, 988504044, 143816789, 991215483, 635637328, 796292638, 712577246, 870774981, 572335077, 92461651, 417842402, 465754445, 443219011, 441495263, 360383390, 613384414, 161967625, 730605620, 45166037, 501067481, 119816381, 482382428, 993423658, 444792073, 338718477, 357679842, 186546204, 725908514, 242243363, 998754918, 228221686, 517265463, 874612151, 181719511, 64245869, 179742910, 880842840, 733045974, 909570009, 761337985, 469116507, 501497182, 26189637, 141834727, 777673597, 739280728, 284499268, 848912007, 618450280, 855914917, 508218929, 64124951, 440691829, 852588078, 555626401, 202070759, 783604366, 202777713, 212620403, 857142928, 324004839, 349402718, 847565789, 52519590, 658472794, 842462660, 791141310, 195364150, 381999943, 261729562, 18229};
	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 10);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(large_10210bit_number, test_o1ka_from_base16,
	 .description = "o_1k.a", .timeout = 1.0)
{
	char *s = "2389bc33ed9d8fac68fd48dc82a0f2df706ecade7871ac10c632e634ee14b433cd061164b6584a6e741ff0cf3f2d1172534753fe8a74dcfa63f595301adff3af942a610742f5a6a65d977c2df06b53d2f1d64c550c2510302f9ee932dbd9a2a5a1bbca7cdf7ed6248f397f1c5911021aade3c3f22a4595e3af7d05281650886ace21e703eb683df6e592d9fbf54c27a74bb31f82d788bfda7e0157fa3f4953f9fb7d2f0cb6752e149c1465ad69ec0c54b09d946491c83c5126ae0100126c37b863dde83816977220aa7c27c89896b4dba43735d890d62e5e185dddf5f4f0229d4e73bf514adcc181280751bd20fabf28c311f100ba546024dbb87b1f785a6e501671bfd02e563f8bb53f8f59abdbba91212b3bf67d93afeba882301baec95d4ad8128798ad1418520f76dafe9c8bed799e096feaa277c74607f9ad91c6604551860fb13e9667236ced824720314ca2b9a01a70270a0aa06a2bfa2e474fab53b5f822759f1cf67e52482fdc91f9613921b16fe90d37ed82f37b8ff6e5687a3f7a8f03b6298f87abd0b5841d5ceb0490e854f7741baff86d19a91c32b835e338185832ad553f5d4dcf14c9e07ebae09e836610bbdf11123ca5c8f67c4676b3cde2de0a4b3517418e0b942d4c62fe145d33dbd4ae7d74a912089a3f441bf16ae8cc600d1d1e4ff400ff96b3ccfa1a116151c355df7df877677ae76bcc6809ca91d0aaf97d156907c6d91106fc10e531145fe81d9ea10336d1d915ed91ef1f950ae9240efa11a4cfd198a92dc30f3ce5a31d6ab9f0d1647914ab2d56cb38ae90af5cd2c0e9a774fa6b9ddbcf1b5efef14efc9551b70e926ed3d26d99a12d6879a43fc282c55e5a82f7176cd6f61196e7502119820a4f2c6ce022c0f69aee4dc7f33d013796c8fe4da9510ba5ae6c98c1e69ff7d949a86e97733691f2e3765c42a76326c2005bcd2e438c8a2863efe79655cd79e3a1037136e4a234ec62384e53480a17a78c71908200050fa4556c17eaf7171ba806a134d246f885bdc31724fd0a0df771424123f05f06fd73cb91b6ef2fee35f5c9e0218e46682c9e2feacfcec574f01ba3bf1274b8dcbd3759f42e655e65203a832f7dc98f9a03cd7fa88626729e7f44ac78e7a3962e46e4492aa4570ee6776a085e711c9e85d056379de1b2e9b4b22a72c25bcaab3106b36453e4428ffa2582efd2392fec4c76259d3c9cd9af77ad458d6da79d64a14f135eba6decd2a2894d9a132bb24a2c968f3f04842e96dd90962f4916cef485925633bcd88699dfdda0c47e1963d8decb0ed19ce07c70eff886af2d25c8255ee382a7e98c0f9505a5cade6a46937d739e72cc7d6291253d58eb4fbe6b576cd5281eae55603ba430a75159223310b7d7ef5e51802559bc852a48833797ec293556d613d650c4b1ea65ab88ad9ec66ea6e636908b6e3ce15e1b8851b2b1d0e1486768406ed8c2ae848c5c7d6890a3655f62ac357d70617e8726e348aee0e1a2c76c94147dbe85233bef5aee954340cc3f0da408d3ebb6c66272af982c2b74e0e117ac26a562f5b46881f0a39353256d1a324bac0de511f69c15026715532e61b673e75099739f0833d279bae23e555a014f9b6d4631fc7e36f675c13e13a7ee4c0df2047e5450ce6033954e53154c5d81c2a7c454856f54be52c61cfdf71c2ac8d99af5a640d6234e6b4aee1f8adbcd02da96456375e959d25fe7a06617454f180277f7d5181330497419a7dc0ccac521993ead48c5c808fdfb40995896244f114dc9d5bbaf0f2fe8f5cb916e95301a240a980c9cc";
	u_int arr[] = {645836236, 108893430, 836208119, 270771001, 537613755, 373039867, 833294108, 898839418, 608485063, 546188873, 452231917, 687296422, 111111152, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 476411111, 5669047, 700035645, 893473278, 4493, 543630640, 324000, 568376700, 1394, 300000000, 378345892, 8, 734194700, 423768, 0, 445197384, 518101037, 109617878, 558156514, 983336821, 690076644, 693516675, 143226629, 76588580, 210759419, 973911560, 497333540, 14322213, 555048869, 815323758, 539167661, 458688023, 612425259, 624332483, 419554373, 679371075, 393235000, 236728315, 664373133, 150410609, 518660305, 359239326, 307363945, 571210805, 347785534, 563445710, 660409386, 228008317, 804462179, 233074148, 591937180, 160409198, 950235053, 962974549, 171857157, 523072994, 395079814, 321058488, 203652900, 126072395, 363107953, 630915068, 973080517, 612433363, 734409773, 377726669, 707225937, 627074076, 918808553, 941285428, 110569912, 430944738, 394600177, 990968620, 4498198, 265970467, 594659210, 881718792, 749254660, 489225907, 417635079, 182995180, 494838468, 16834009, 911110449, 948701330, 831191398, 792151714, 70940218, 627665839, 410612359, 202045867, 935804051, 937850141, 227018012, 991791152, 506752363, 406483698, 355792683, 47491630, 22359011, 919962818, 955165934, 399211808, 673319428, 319818160, 662785141, 175882430, 630322415, 735383534, 687650610, 46582669, 496678148, 491637987, 871575195, 116330034, 723314187, 385420689, 325094262, 12829142, 208703866, 120005690, 899921757, 77002169, 359486189, 753454258, 278911354, 694037307, 578519296, 494600786, 470779501, 768446187, 472669563, 716361937, 389127515, 976446119, 593192334, 617083917, 272976737, 418747631, 855714255, 226105187, 605917499, 696971445, 573117854, 99153257, 956645492, 728520292, 946389174, 245482697, 655465609, 470307816, 135416351, 729216591, 866144546, 888959338, 809402688, 527131609, 866613186, 419167460, 916600904, 633154349, 747140489, 315862951, 238759183, 148584074, 652667824, 161606397, 677427537, 590777629, 825244648, 835356427, 366982335, 748040826, 852122159, 4896, 900000000, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 385820199, 167580321, 134092496, 277075937, 872169008, 64325722, 827080282, 277960712, 655352740, 163131699, 448213684, 277128786, 514326330, 933871396, 63154105, 745922799, 490015860, 252229607, 711956623, 591788040, 954758766, 467124003, 644524713, 690634208, 510828673, 629041620, 704066384, 468512842, 590156377, 509105852, 101803594, 777808979, 519622805, 972925209, 333284887, 366099858, 584319133, 851605740, 743738793, 912271659, 205902321, 306768696, 951511006, 853007337, 793747247, 858293618, 953587774, 433638706, 827128463, 10931106, 238240138, 541935268, 774418024, 534563619, 736369239, 336516542, 723202909, 72035747, 712282212, 121201039, 863656439, 738195137, 536402352, 988504044, 143816789, 991215483, 635637328, 796292638, 712577246, 870774981, 572335077, 92461651, 417842402, 465754445, 443219011, 441495263, 360383390, 613384414, 161967625, 730605620, 45166037, 501067481, 119816381, 482382428, 993423658, 444792073, 338718477, 357679842, 186546204, 725908514, 242243363, 998754918, 228221686, 517265463, 874612151, 181719511, 64245869, 179742910, 880842840, 733045974, 909570009, 761337985, 469116507, 501497182, 26189637, 141834727, 777673597, 739280728, 284499268, 848912007, 618450280, 855914917, 508218929, 64124951, 440691829, 852588078, 555626401, 202070759, 783604366, 202777713, 212620403, 857142928, 324004839, 349402718, 847565789, 52519590, 658472794, 842462660, 791141310, 195364150, 381999943, 261729562, 18229};
	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 16);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(large_10210bit_number, test_o1ka_from_base36,
	 .description = "o_1k.a", .timeout = 1.0)
{
	char *s = "d665q438en469vydae19k8cxe8slndpgvuacst1kg784ixrhe8zyqky2m0t5ftrsknftspcvxdodfj12rztwkn8f3jv4iz5ugq9akkw9tulphjh8t56qvpngo1mvuph16jtbfk1f7au2x28dz4u9te9xecwkz73a1u7753zzg9ybe88z7y0t3nb5u6i87xy45gaqy64nhcf2vgfbth7ekux64lujori3a6tlbtnm3514i4aww1hvf4fgs17qblrnz3y4eqcxax08uq5ti2jjkhsj15fetztu41nt35jirjs435mtygwsvnncg4wihf0k05qnijjzixuj78drog6xrx764so6qsr8c3pqcau7c3gbu4d12fj1ubrkrah6yv9zu3q6ynxhmzu2w325631v89vajffxa9xgs7u2z2iur3a5464rj36x8hw8yxau8t601klo7rgm81fl9q8t2gd3yskxneizxtqcv3lll7q94hmfb2o74c6f3c80m87ujqkjci02ewf6l39m0mhd7uwte71uz1mhd8pm8c2nbad70u0lvttfu3ybu36skh36fkqwxgmuto5sue9g4pzpj7r7wrxt1atr6rae69xa6ngeo15o78kkhhz1hkf1ddwmhdex032onpa0csbmzq8r73g609sfp6t67lgfwdg0k84kj9j1zbnjpfro7br03zqs0u7e8oibdg4nia79ypik5xiw6cov9saom8sk3870ras9weyfoi8775vcfyilho0e0ga80e66pgdq5timp0yagnn0xf8angeszuyy20obdbq4ho81ag4e3lwvo9y7qhnujn8mln7qnz2a7ymdcceyiuvvkar6k1powhpaw8znp711n656vbu12bo182munc89jhqjke31gg0sibzsql5a8na8qo219xpjhucoq3fz9lvxb9dny2d8edq4zwa6oyumjg3kjg9p3vavkwuk47j9zlnz4dpuq6nb9ymniwa9v4186mabw7hj2cyn5oba32v28o1ulb0gba7i7kwgbi26f5u7q9w22v7fc807i8aekzl0w6scb432qspqq4ws94sb0wwa1g5wx5r03g4d67e631legxrg7yi00y9bjh4xwn5pr6snl5z5i1i20yq0j7eg6ikhf2mt6ngh55v30x5ji7eq0sdtg44ptv6v47aaq9adzkvelvv7zjwjgok0o8qhgihv8tt43o2opbsp6lt5gx93peutu9wy8wadgael5296zhmqxef31kowyl6j77xk1kphkbyj0ocox5ctfb5bhewjosdecbblx10o6913vw2z9feo1j63rp5mo8woxoj6ro5bl93hqti6w2eo30ex8rsqk1qtrnxsbs3ko8jqxskrs6602mjt34chawa9lvrfbqsr4uteu29l28e0gyljxwtwgao8ze8lfqndt141f407ulcp1pms3imgp4z93wkd9kymfjnclqb2k9t3hgtkv6gerjupswt2gpw8lm1kvrdzwhae0yeol01slvdjw5zkb9ijmheste07o434nnsvc4tfstonmz9ydbqvwydzpsbp3yyb1w9i82y6v00kt4etcmdh383pysyh6uwxocvvy0fssx9saqt8uocsadjwipthy4qbei1pwghqttcwsgjk668xqr0n2afoold6h1byy32yu90kp5w07lxvwbt730ixpch4xloka9axb1iolr2hy5lzw5zm7vismepgwbxyz0yrlzepqa228kpbbc4fdlp4psaa7x7k2k0g4avbonp4jiawq7slnecziq4njr0candova4dlyjdq2yd3lr4y9gbtgcalnr7jm0spd35f4e1jebixmt3utp362gfpz3vgyr785c3egbjb5n3gei8gc21r4af45er1dnngvxzm1e7uhplsq148kaxsg7ngvurjwfoyq1dz6g44vbqfo3mbp40ttpylpmnwc4w2q4";
	u_int arr[] = {645836236, 108893430, 836208119, 270771001, 537613755, 373039867, 833294108, 898839418, 608485063, 546188873, 452231917, 687296422, 111111152, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 476411111, 5669047, 700035645, 893473278, 4493, 543630640, 324000, 568376700, 1394, 300000000, 378345892, 8, 734194700, 423768, 0, 445197384, 518101037, 109617878, 558156514, 983336821, 690076644, 693516675, 143226629, 76588580, 210759419, 973911560, 497333540, 14322213, 555048869, 815323758, 539167661, 458688023, 612425259, 624332483, 419554373, 679371075, 393235000, 236728315, 664373133, 150410609, 518660305, 359239326, 307363945, 571210805, 347785534, 563445710, 660409386, 228008317, 804462179, 233074148, 591937180, 160409198, 950235053, 962974549, 171857157, 523072994, 395079814, 321058488, 203652900, 126072395, 363107953, 630915068, 973080517, 612433363, 734409773, 377726669, 707225937, 627074076, 918808553, 941285428, 110569912, 430944738, 394600177, 990968620, 4498198, 265970467, 594659210, 881718792, 749254660, 489225907, 417635079, 182995180, 494838468, 16834009, 911110449, 948701330, 831191398, 792151714, 70940218, 627665839, 410612359, 202045867, 935804051, 937850141, 227018012, 991791152, 506752363, 406483698, 355792683, 47491630, 22359011, 919962818, 955165934, 399211808, 673319428, 319818160, 662785141, 175882430, 630322415, 735383534, 687650610, 46582669, 496678148, 491637987, 871575195, 116330034, 723314187, 385420689, 325094262, 12829142, 208703866, 120005690, 899921757, 77002169, 359486189, 753454258, 278911354, 694037307, 578519296, 494600786, 470779501, 768446187, 472669563, 716361937, 389127515, 976446119, 593192334, 617083917, 272976737, 418747631, 855714255, 226105187, 605917499, 696971445, 573117854, 99153257, 956645492, 728520292, 946389174, 245482697, 655465609, 470307816, 135416351, 729216591, 866144546, 888959338, 809402688, 527131609, 866613186, 419167460, 916600904, 633154349, 747140489, 315862951, 238759183, 148584074, 652667824, 161606397, 677427537, 590777629, 825244648, 835356427, 366982335, 748040826, 852122159, 4896, 900000000, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 385820199, 167580321, 134092496, 277075937, 872169008, 64325722, 827080282, 277960712, 655352740, 163131699, 448213684, 277128786, 514326330, 933871396, 63154105, 745922799, 490015860, 252229607, 711956623, 591788040, 954758766, 467124003, 644524713, 690634208, 510828673, 629041620, 704066384, 468512842, 590156377, 509105852, 101803594, 777808979, 519622805, 972925209, 333284887, 366099858, 584319133, 851605740, 743738793, 912271659, 205902321, 306768696, 951511006, 853007337, 793747247, 858293618, 953587774, 433638706, 827128463, 10931106, 238240138, 541935268, 774418024, 534563619, 736369239, 336516542, 723202909, 72035747, 712282212, 121201039, 863656439, 738195137, 536402352, 988504044, 143816789, 991215483, 635637328, 796292638, 712577246, 870774981, 572335077, 92461651, 417842402, 465754445, 443219011, 441495263, 360383390, 613384414, 161967625, 730605620, 45166037, 501067481, 119816381, 482382428, 993423658, 444792073, 338718477, 357679842, 186546204, 725908514, 242243363, 998754918, 228221686, 517265463, 874612151, 181719511, 64245869, 179742910, 880842840, 733045974, 909570009, 761337985, 469116507, 501497182, 26189637, 141834727, 777673597, 739280728, 284499268, 848912007, 618450280, 855914917, 508218929, 64124951, 440691829, 852588078, 555626401, 202070759, 783604366, 202777713, 212620403, 857142928, 324004839, 349402718, 847565789, 52519590, 658472794, 842462660, 791141310, 195364150, 381999943, 261729562, 18229};
	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 36);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

TestSuite(long_1970bit_number, .init = setup, .fini = teardown);

Test(long_1970bit_number, test_o500d_from_base2,
	 .description = "o_500.d", .timeout = 1.0)
{
	char *s = "11101111011010011101011001111111001110001000110000100111111000001011011000110101010100010010111100011111110011110011000110010000100101110101111011010010101101101100101100010110110001101100111110110011000111101010011110001011011001111000101001110000010100100000111110110110110000101011001100111111101101000110100001100101110100010000111100101111001001000001001100001000110110010100001110111100011000000010010100110011111000110001001101101100000100100101110001000011110001101101001001001010110111110001100001100110101110101100000011110111010111101001101011000001111000011001011101010111001001010001110000010001111011011000010011001100110100111010111001010011111110000110101111011011000011000001101001011100010101110001001101110110001000010101101010000100111001011000111100101001110011100100011000101110111000101001010001011000100011001110001001111001100011100000111111111110100111000001000010001011001100100100100011110110011111010110010111110110110111100011001000001001101111110110101010111100001000110011101011011011111001111001110011111011101100101001100010101000101110111100001000011001101100010100011010000111010110001001111011010110001101100011100110011111001000010100011101000000111110000100011100011100010101100111011101010001101011001101110000010000001110000101011100001100010111111010000110001011100000111001111001111000010100111011111011011110100001100100011100100110111110101010110110010101110011000000111101100001000101101101000100011110101010001001010100101100010100001111010010110111000001110110000110100010110000000011101010000100110011101111101111110000001000000000000111101101100101111111100011000011101011001111101011111111110111010101000100000100011011011110000000111101000111100000011011101110010110100010011110110000000100001100101101101100001110001110101011101011111001101100100010100001001100111000110011111001001110100110010010010010010000100100100100010101110101010100111110101111110000000001000101010111110111101111000010001100000011100011100011";
	u_int arr[] = {555555555, 55555555, 0, 0, 0, 0, 222222, 0, 0, 0, 0, 0, 0, 0, 0, 888888888, 888888888, 888888888, 888888888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110000000, 111111111, 111111111, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 770000000, 777777777, 777777777, 777777, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 999000000, 99999999};
	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 2);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(long_1970bit_number, test_o500d_from_base8,
	 .description = "o_500.d", .timeout = 1.0)
{
	char *s = "357323531771610604770133065242274376363062045657322555454266154766307523613317051602440766660531477550641456420745711011410662416743002246370611554044561036155111267614146565403672751530170313527112160217330231464727123760657330301513425611566102552047130745163443056705121304316117143407776470102131444436637262766674310115766527410635333717163735451425056741031542432072611732615434637102435007604343425473521531560201605341427720613407171702473733641443446765266256300754105550436521124542417226701660642600352046357576010000755457743035317537767250404333600750740335626423660041455541616535371544241147063711646222220444425652476576001052767570214034343";
	u_int arr[] = {555555555, 55555555, 0, 0, 0, 0, 222222, 0, 0, 0, 0, 0, 0, 0, 0, 888888888, 888888888, 888888888, 888888888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110000000, 111111111, 111111111, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 770000000, 777777777, 777777777, 777777, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 999000000, 99999999};
	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 8);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(long_1970bit_number, test_o500d_from_base10,
	 .description = "o_500.d", .timeout = 1.0)
{
	char *s = "99999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000777777777777777777777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000888888888888888888888888888888888888000000000000000000000000000000000000000000000000000000000000000000000000000222222000000000000000000000000000000000000055555555555555555";
	u_int arr[] = {555555555, 55555555, 0, 0, 0, 0, 222222, 0, 0, 0, 0, 0, 0, 0, 0, 888888888, 888888888, 888888888, 888888888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110000000, 111111111, 111111111, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 770000000, 777777777, 777777777, 777777, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 999000000, 99999999};
	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 10);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(long_1970bit_number, test_o500d_from_base16,
	 .description = "o_500.d", .timeout = 1.0)
{
	char *s = "3bda759fce2309f82d8d544bc7f3cc6425d7b4adb2c5b1b3ecc7a9e2d9e29c1483edb0accfed1a197443cbc904c23650ef18094cf8c4db049710f1b492b7c619aeb03dd7a6b07865d5c947047b613334eb94fe1af6c3069715c4dd8856a13963ca73918bb8a51623389e6383ffa70422cc923d9f597db78c826fdaaf08ceb6f9e73eeca62a2ef0866c51a1d627b58d8e67c851d03e11c7159dd46b37040e15c317e862e0e79e14efb7a191c9beab657303d845b447aa254b143d2dc1d868b00ea133befc08007b65fe30eb3ebff754411b780f4781bb9689ec0432db0e3abaf9b2284ce33e4e99249092457553ebf00455f7bc23038e3";
	u_int arr[] = {555555555, 55555555, 0, 0, 0, 0, 222222, 0, 0, 0, 0, 0, 0, 0, 0, 888888888, 888888888, 888888888, 888888888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110000000, 111111111, 111111111, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 770000000, 777777777, 777777777, 777777, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 999000000, 99999999};
	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 16);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}

Test(long_1970bit_number, test_o500d_from_base36,
	 .description = "o_500.d", .timeout = 1.0)
{
	char *s = "149y3nx5j8podu86vof4iuy8vlvbuftosbcdcuxun0wz4oeqnx8nmhplxwrjskefc40ltwex6pdkbeytyqtg28rrss8m1oiohs4m02vgb5fhh4vteov6iob6z6mecmmpl2135zxt22nw63inncs00ablj2ba4k3177qajc5zyj08ljhzgvso6h8907huax92nv9vu9lt132cbuwyhdp7sekbaufg42h5qqe36dc8rm6ybc27j2nat0poxsfgig7cuvekvcjzuvi9xbinof90no5xws1e4dj27samyjn73vn20puhjozavp0it5oy7tsyxxu00bflzfuef49j38cm5exvtoysd9ljdreb0077c79j3epn9crp57p96dhejn";
	u_int arr[] = {555555555, 55555555, 0, 0, 0, 0, 222222, 0, 0, 0, 0, 0, 0, 0, 0, 888888888, 888888888, 888888888, 888888888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110000000, 111111111, 111111111, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 770000000, 777777777, 777777777, 777777, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 999000000, 99999999};
	numstr in = {.len = strlen(s), .is_negative = false, .str = s};
	bigint out = {
		.len = sizeof(arr) / sizeof(*arr), .is_negative = false, .num = arr};

	output = anybase_to_bni(&in, 36);
	cr_assert(eq(sz, output->len, out.len));
	cr_assert(eq(chr, output->is_negative, out.is_negative));
	cr_assert(eq(u32[out.len], output->num, out.num));
}
