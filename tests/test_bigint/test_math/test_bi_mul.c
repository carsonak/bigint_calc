#include "tests.h"

struct invalid_inputs
{
	bigint num1, num2, expected, *output;
};

TEST_F_SETUP(invalid_inputs) { memset(tau, 0, sizeof(*tau)); }

TEST_F_TEARDOWN(invalid_inputs) { tau->output = bi_delete(tau->output); }

TEST_F(invalid_inputs, test_null_times_null)
{
	tau->output = bi_multiply(NULL, NULL);

	CHECK_PTR_EQ(tau->output, NULL);
}

TEST_F(invalid_inputs, test_1_times_null)
{
	u_int in1[] = {1};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->output = bi_multiply(&(tau->num1), NULL);

	CHECK_PTR_EQ(tau->output, NULL);
}

TEST_F(invalid_inputs, test_null_times_1)
{
	u_int in2[] = {1};

	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->output = bi_multiply(NULL, &(tau->num2));

	CHECK_PTR_EQ(tau->output, NULL);
}

TEST_F(invalid_inputs, test_0_times_null)
{
	u_int in1[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->output = bi_multiply(&(tau->num1), NULL);

	CHECK_PTR_EQ(tau->output, NULL);
}

TEST_F(invalid_inputs, test_null_times_0)
{
	u_int in2[1] = {0};

	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->output = bi_multiply(NULL, &(tau->num2));

	CHECK_PTR_EQ(tau->output, NULL);
}

TEST_F(invalid_inputs, test_neg1_times_null)
{
	u_int in1[] = {1};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num1.is_negative = true;
	tau->output = bi_multiply(&(tau->num1), NULL);

	CHECK_PTR_EQ(tau->output, NULL);
}

TEST_F(invalid_inputs, test_null_times_neg1)
{
	u_int in2[] = {1};

	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->num2.is_negative = true;
	tau->output = bi_multiply(NULL, &(tau->num2));

	CHECK_PTR_EQ(tau->output, NULL);
}

/* NaN */

TEST_F(invalid_inputs, test_NaN_times_NaN)
{
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_PTR_EQ(tau->output->num, NULL);
}

TEST_F(invalid_inputs, test_4490998_times_NaN)
{
	u_int in1[] = {4490998};

	tau->num1 = (bigint){.len = sizeof(in1) / sizeof(*in1),
						 .is_negative = false,
						 .num = in1};
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_PTR_EQ(tau->output->num, NULL);
}

TEST_F(invalid_inputs, test_NaN_times_largenum)
{
	u_int in2[] = {238542068, 232509426, 6086, 0, 0, 712000569, 99992175};

	tau->num2 = (bigint){.len = sizeof(in2) / sizeof(*in2),
						 .is_negative = false,
						 .num = in2};
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_PTR_EQ(tau->output->num, NULL);
}

struct simple_multiplications
{
	bigint num1, num2, expected, *output;
};

TEST_F_SETUP(simple_multiplications) { memset(tau, 0, sizeof(*tau)); }

TEST_F_TEARDOWN(simple_multiplications)
{
	tau->output = bi_delete(tau->output);
}

TEST_F(simple_multiplications, test_0_times_0)
{
	u_int in1[1] = {0}, in2[1] = {0}, out[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_1_times_0)
{
	u_int in1[] = {1}, in2[1] = {0}, out[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_0_times_1)
{
	u_int in1[1] = {0}, in2[] = {1}, out[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_1_times_1)
{
	u_int in1[] = {1}, in2[] = {1}, out[] = {1};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_long_times_0)
{
	u_int in1[] = {691273964, 472346283, 197812382, 3, 0, 938736};
	u_int in2[1] = {0}, out[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/******************** REVERSE OF PREVIOUS ********************/

TEST_F(simple_multiplications, test_0_times_long)
{
	u_int in1[1] = {0}, out[1] = {0};
	u_int in2[] = {691273964, 472346283, 197812382, 3, 0, 938736};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_u100c_times_u100d)
{
	/* clang-format off */
	u_int in1[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112};
	u_int in2[] = {300000000, 376573322, 777777774, 998777777, 1230};
	u_int out[] = {0, 536000000, 792013003, 554218996, 878072308, 817519667, 394484502, 335339231, 282664403, 190091042, 714545884, 131};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/******************** REVERSE OF PREVIOUS ********************/

TEST_F(simple_multiplications, test_u100d_times_u100c)
{
	/* clang-format off */
	u_int in1[] = {300000000, 376573322, 777777774, 998777777, 1230};
	u_int in2[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112};
	u_int out[] = {0, 536000000, 792013003, 554218996, 878072308, 817519667, 394484502, 335339231, 282664403, 190091042, 714545884, 131};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

struct negative_multiplications
{
	bigint num1, num2, expected, *output;
};

TEST_F_SETUP(negative_multiplications) { memset(tau, 0, sizeof(*tau)); }

TEST_F_TEARDOWN(negative_multiplications)
{
	tau->output = bi_delete(tau->output);
}

TEST_F(negative_multiplications, test_minus_u100a_times_minus_u100c)
{
	/* clang-format off */
	u_int in1[] = {1, 0, 0, 0, 0, 0, 0, 0, 1000};
	u_int in2[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112};
	u_int out[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112, 0, 0, 948320, 0, 562372840, 839999908, 854667188, 998112639, 106};
	/* clang-format on */

	tau->num1 = (bigint){.len = sizeof(in1) / sizeof(*in1),
						 .is_negative = true,
						 .num = in1};
	tau->num2 = (bigint){.len = sizeof(in2) / sizeof(*in2),
						 .is_negative = true,
						 .num = in2};
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/******************** REVERSE OF PREVIOUS ********************/

TEST_F(negative_multiplications, test_minus_u100c_times_minus_u100a)
{
	/* clang-format off */
	u_int in1[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112};
	u_int in2[] = {1, 0, 0, 0, 0, 0, 0, 0, 1000};
	u_int out[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112, 0, 0, 948320, 0, 562372840, 839999908, 854667188, 998112639, 106};
	/* clang-format on */

	tau->num1 = (bigint){.len = sizeof(in1) / sizeof(*in1),
						 .is_negative = true,
						 .num = in1};
	tau->num2 = (bigint){.len = sizeof(in2) / sizeof(*in2),
						 .is_negative = true,
						 .num = in2};
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(negative_multiplications, test_u100a_times_minus_u100c)
{
	/* clang-format off */
	u_int in1[] = {1, 0, 0, 0, 0, 0, 0, 0, 1000};
	u_int in2[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112};
	u_int out[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112, 0, 0, 948320, 0, 562372840, 839999908, 854667188, 998112639, 106};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2 = (bigint){.len = sizeof(in2) / sizeof(*in2),
						 .is_negative = true,
						 .num = in2};
	tau->expected = (bigint){.len = sizeof(out) / sizeof(*out),
							 .is_negative = true,
							 .num = out};
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/******************** REVERSE OF PREVIOUS ********************/

TEST_F(negative_multiplications, test_minus_u100c_times_u100a)
{
	/* clang-format off */
	u_int in1[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112};
	u_int in2[] = {1, 0, 0, 0, 0, 0, 0, 0, 1000};
	u_int out[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112, 0, 0, 948320, 0, 562372840, 839999908, 854667188, 998112639, 106};
	/* clang-format on */

	tau->num1 = (bigint){.len = sizeof(in1) / sizeof(*in1),
						 .is_negative = true,
						 .num = in1};
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected = (bigint){.len = sizeof(out) / sizeof(*out),
							 .is_negative = true,
							 .num = out};
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(negative_multiplications, test_minus_u100a_times_u100c)
{
	/* clang-format off */
	u_int in1[] = {1, 0, 0, 0, 0, 0, 0, 0, 1000};
	u_int in2[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112};
	u_int out[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112, 0, 0, 948320, 0, 562372840, 839999908, 854667188, 998112639, 106};
	/* clang-format on */

	tau->num1 = (bigint){.len = sizeof(in1) / sizeof(*in1),
						 .is_negative = true,
						 .num = in1};
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = in2;
	tau->expected = (bigint){.len = sizeof(out) / sizeof(*out),
							 .is_negative = true,
							 .num = out};
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/******************** REVERSE OF PREVIOUS ********************/

TEST_F(negative_multiplications, test_u100c_times_minus_u100a)
{
	/* clang-format off */
	u_int in1[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112};
	u_int in2[] = {1, 0, 0, 0, 0, 0, 0, 0, 1000};
	u_int out[] = {320000000, 948, 840000000, 908562372, 188839999, 639854667, 106998112, 0, 0, 948320, 0, 562372840, 839999908, 854667188, 998112639, 106};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->num2 = (bigint){.len = sizeof(in2) / sizeof(*in2),
						 .is_negative = true,
						 .num = in2};
	tau->expected = (bigint){.len = sizeof(out) / sizeof(*out),
							 .is_negative = true,
							 .num = out};
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

struct large_multiplications
{
	bigint num1, num2, expected, *output;
};

TEST_F_SETUP(large_multiplications) { memset(tau, 0, sizeof(*tau)); }

TEST_F_TEARDOWN(large_multiplications)
{
	tau->output = bi_delete(tau->output);
	free(tau->num1.num);
	free(tau->num2.num);
}

TEST_F(large_multiplications, test_o1kb_times_o1kc)
{
	/* clang-format off */
	u_int in1[] = {645836236, 108893430, 836208119, 270771001, 537613755, 373039867, 833294108, 898839418, 608485063, 546188873, 452231917, 687296422, 111111152, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 476411111, 5669047, 700035645, 893473278, 4493, 543630640, 324000, 568376700, 1394, 300000000, 378345892, 8, 734194700, 423768, 0, 445197384, 518101037, 109617878, 558156514, 983336821, 690076644, 693516675, 143226629, 76588580, 210759419, 973911560, 497333540, 14322213, 555048869, 815323758, 539167661, 458688023, 612425259, 624332483, 419554373, 679371075, 393235000, 236728315, 664373133, 150410609, 518660305, 359239326, 307363945, 571210805, 347785534, 563445710, 660409386, 228008317, 804462179, 233074148, 591937180, 160409198, 950235053, 962974549, 171857157, 523072994, 395079814, 321058488, 203652900, 126072395, 363107953, 630915068, 973080517, 612433363, 734409773, 377726669, 707225937, 627074076, 918808553, 941285428, 110569912, 430944738, 394600177, 990968620, 4498198, 265970467, 594659210, 881718792, 749254660, 489225907, 417635079, 182995180, 494838468, 16834009, 911110449, 948701330, 831191398, 792151714, 70940218, 627665839, 410612359, 202045867, 935804051, 937850141, 227018012, 991791152, 506752363, 406483698, 355792683, 47491630, 22359011, 919962818, 955165934, 399211808, 673319428, 319818160, 662785141, 175882430, 630322415, 735383534, 687650610, 46582669, 496678148, 491637987, 871575195, 116330034, 723314187, 385420689, 325094262, 12829142, 208703866, 120005690, 899921757, 77002169, 359486189, 753454258, 278911354, 694037307, 578519296, 494600786, 470779501, 768446187, 472669563, 716361937, 389127515, 976446119, 593192334, 617083917, 272976737, 418747631, 855714255, 226105187, 605917499, 696971445, 573117854, 99153257, 956645492, 728520292, 946389174, 245482697, 655465609, 470307816, 135416351, 729216591, 866144546, 888959338, 809402688, 527131609, 866613186, 419167460, 916600904, 633154349, 747140489, 315862951, 238759183, 148584074, 652667824, 161606397, 677427537, 590777629, 825244648, 835356427, 366982335, 748040826, 852122159, 4896, 900000000, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 385820199, 167580321, 134092496, 277075937, 872169008, 64325722, 827080282, 277960712, 655352740, 163131699, 448213684, 277128786, 514326330, 933871396, 63154105, 745922799, 490015860, 252229607, 711956623, 591788040, 954758766, 467124003, 644524713, 690634208, 510828673, 629041620, 704066384, 468512842, 590156377, 509105852, 101803594, 777808979, 519622805, 972925209, 333284887, 366099858, 584319133, 851605740, 743738793, 912271659, 205902321, 306768696, 951511006, 853007337, 793747247, 858293618, 953587774, 433638706, 827128463, 10931106, 238240138, 541935268, 774418024, 534563619, 736369239, 336516542, 723202909, 72035747, 712282212, 121201039, 863656439, 738195137, 536402352, 988504044, 143816789, 991215483, 635637328, 796292638, 712577246, 870774981, 572335077, 92461651, 417842402, 465754445, 443219011, 441495263, 360383390, 613384414, 161967625, 730605620, 45166037, 501067481, 119816381, 482382428, 993423658, 444792073, 338718477, 357679842, 186546204, 725908514, 242243363, 998754918, 228221686, 517265463, 874612151, 181719511, 64245869, 179742910, 880842840, 733045974, 909570009, 761337985, 469116507, 501497182, 26189637, 141834727, 777673597, 739280728, 284499268, 848912007, 618450280, 855914917, 508218929, 64124951, 440691829, 852588078, 555626401, 202070759, 783604366, 202777713, 212620403, 857142928, 324004839, 349402718, 847565789, 52519590, 658472794, 842462660, 791141310, 195364150, 381999943, 261729562, 18229};
	u_int in2[] = {120720357, 397122822, 391212010, 378636564, 527381951, 445364023, 899885040, 831438167, 289912154, 386356373, 467962926, 817125772, 778707749, 515723350, 20924616, 454178424, 114657544, 634432190, 904414952, 143603833, 256133844, 201619676, 377306056, 810451660, 815010674, 281198163, 584823824, 739934236, 774447920, 423387184, 43576798, 141865462, 637259085, 182422433, 869987549, 632282216, 515172654, 118746121, 691817195, 100642458, 401797429, 748808428, 97330459, 859095700, 77613379, 824691165, 375014971, 270261896, 971418347, 287776735, 687392807, 72844992, 808489120, 176184502, 298559149, 515082189, 290641249, 784406918, 18525880, 595556264, 662020707, 137836043, 32027777, 282126204, 398571429, 183240048, 893494027, 908475657, 210325195, 41368093, 567494670, 78549187, 829867982, 939611731, 556446171, 260470617, 388185363, 898568742, 584926832, 930685864, 974259747, 196534676, 548532814, 760521395, 176790149, 995282978, 514569063, 129660418, 873623608, 869739334, 116299016, 931525892, 602082336, 842229732, 82941119, 584280220, 738070679, 549296857, 554682269, 129930289, 352088067, 846285574, 807033108, 924619988, 410518654, 524776378, 210726853, 338324773, 234371231, 345598217, 215913853, 40125185, 169659817, 614457144, 263430597, 839552963, 357693985, 358911228, 31559180, 973973025, 529509086, 130265707, 902771569, 939005219, 909614411, 481137671, 453755527, 315076922, 190488385, 858980849, 914750855, 893492457, 44932638, 537640698, 831905869, 686543771, 164968285, 32694655, 549006585, 907130711, 937753741, 473161761, 60159427, 193787354, 490610706, 977776760, 692607694, 6731141, 102078922, 359416565, 975892579, 663415745, 486552688, 501065002, 401362961, 293547871, 954030315, 717222449, 171804201, 933246578, 628660373, 388008411, 546067821, 318550725, 990682255, 492064339, 647433279, 137385221, 703102597, 102835383, 283915020, 951593059, 607687526, 836935402, 684651719, 23912707, 349733186, 901432221, 855504886, 181532375, 353916766, 945868802, 361242525, 362433248, 541955437, 67937107, 539323500, 323672831, 966437313, 515041060, 651866030, 535923932, 530736394, 457121080, 34778553, 656344571, 766040938, 922800831, 880446217, 23307414, 859193718, 316040919, 995023505, 796297454, 417185715, 452307299, 839507981, 32105848, 520365290, 312607239, 836310795, 763091506, 397308051, 361243336, 973440977, 737772666, 670722593, 362707407, 891880855, 294128542, 811056991, 743094473, 39460017, 899096862, 700449819, 26597046, 259465921, 88171879, 774925466, 948922590, 41763507, 818299518, 949483846, 901683400, 91111044, 894870133, 483119139, 879215171, 907094021, 962766583, 741061235, 120204586, 193580405, 293785014, 701801};
	u_int out[] = {973456252, 412698082, 156854265, 231236880, 474358034, 679091949, 447758531, 493377411, 637994538, 575462518, 915755352, 555293881, 482859668, 676700950, 334034557, 28408988, 482628258, 579259594, 738872206, 871197308, 702265474, 735864594, 157512557, 926743357, 882048537, 11150613, 523219675, 755874332, 581977406, 211329093, 984017167, 57567319, 514051826, 791772321, 792638993, 760554402, 43145462, 193551802, 565360348, 17126266, 472717017, 346875411, 481924938, 7117958, 479017028, 247605729, 209278489, 840696239, 392147532, 53495250, 504210065, 502046351, 714511625, 881956908, 62941673, 916753945, 486652595, 412929118, 54954346, 869595157, 382728091, 722988513, 335328409, 634858740, 256572717, 674203563, 11600175, 418581840, 405046569, 423979357, 951659798, 727308504, 147846721, 768544058, 903047950, 295815064, 868897303, 158285362, 949970028, 326721887, 96356142, 812585111, 896931597, 284906965, 874823497, 905386578, 874287653, 607465176, 624185734, 560032461, 392420655, 8741201, 570521627, 187892696, 989242173, 79457270, 461279755, 178329389, 863762415, 784766683, 31200121, 235831641, 266812872, 199500139, 41723628, 544094501, 857075377, 728444420, 941631074, 404474606, 554179674, 578222996, 797987054, 818738326, 750114941, 50103196, 702184938, 613585960, 665317743, 89904246, 998763247, 339029123, 612595234, 311369789, 959610269, 256630824, 806914657, 793679993, 773620201, 656505563, 994393849, 83683155, 683539241, 804011207, 814146601, 718972641, 845237219, 821538729, 996169319, 35360267, 188778355, 171516559, 708660738, 675157272, 476122012, 900085612, 674772993, 833334730, 10283515, 479131685, 598115734, 369471312, 457491682, 743913010, 156425832, 522883672, 386468073, 772647334, 565053022, 562706849, 445012977, 493314535, 615502660, 322329933, 81383481, 271443191, 643358277, 165941717, 986778798, 752550196, 909173766, 375154039, 511109692, 394859628, 384146192, 507157613, 158454506, 791999371, 324651095, 711961205, 468979783, 254824501, 616886879, 746634373, 489181536, 506140156, 444347759, 634431730, 273551361, 375807327, 502322677, 292149421, 966534332, 57901320, 450439429, 695626107, 163249440, 694453265, 334196451, 109269266, 681332690, 861225219, 7573952, 23684526, 911385340, 921755065, 545439132, 830528350, 584344913, 907999009, 155084801, 713641398, 208952730, 997477963, 408430834, 23929822, 704162858, 155645295, 13570028, 595968323, 792853920, 717155113, 60375533, 875568440, 84416889, 283735593, 613303615, 323997640, 158793785, 806776977, 343428972, 60189921, 693181877, 450069176, 969912778, 533925309, 635186714, 178044482, 417746812, 389330418, 40064830, 116884312, 695388930, 630170261, 336660214, 215980765, 916786927, 748054826, 485554673, 134452359, 308228183, 478022556, 966390076, 439246974, 229665139, 858393286, 978296503, 371719426, 629798177, 679786960, 402143518, 283524678, 451155328, 473585934, 548242332, 584125220, 673950073, 260484559, 739354747, 881533924, 26361124, 116924967, 555237505, 99529654, 896048195, 61934823, 160601585, 68047935, 745268295, 416848656, 869553347, 26234477, 692261965, 808106330, 368939608, 849358439, 670595250, 644257130, 596214304, 463399078, 275448545, 727776118, 587712963, 357837625, 164679319, 951643847, 563042657, 830792179, 898451375, 696965900, 208643746, 981614459, 707936773, 495532392, 636082905, 46998285, 998285197, 667305176, 626063933, 533179955, 852260195, 663445217, 529155749, 115445158, 577011797, 25167443, 204047256, 528091432, 119995549, 195632980, 244146639, 739403804, 941838780, 398481977, 483670969, 492958219, 666322530, 527176054, 986460574, 719557393, 674996087, 382550968, 16803867, 173650919, 740280510, 231187964, 754874386, 950555752, 780118606, 101946412, 535080386, 174433453, 334398158, 115832425, 825054471, 389454401, 725668657, 818920111, 172048484, 655057164, 865548808, 488417742, 543910662, 836247751, 666824852, 156780165, 860772084, 143283360, 58418781, 563326303, 435594916, 229167653, 32831233, 652408171, 839839122, 321889398, 821805902, 551017937, 34299250, 878004560, 944623782, 708591772, 214464763, 277627044, 906269682, 610260566, 767915418, 728864978, 834927805, 999929693, 500994779, 535375840, 23423948, 902176013, 648632566, 128840743, 301398950, 553163152, 323527568, 638326068, 658944113, 60443061, 668747641, 113060422, 448574319, 592719878, 2176602, 388104636, 11280977, 577457862, 728759188, 519861282, 964856560, 142865932, 928150663, 430600900, 668499938, 799275115, 263903, 85263396, 510302143, 959387652, 932233414, 760434309, 877255999, 573782281, 520481225, 652841903, 482562292, 903603164, 723593546, 76083784, 136573214, 967418740, 349005310, 81834840, 683948859, 860511074, 370207012, 424903007, 901105805, 754764642, 849934405, 512138206, 837848485, 87432107, 417398926, 471026245, 599294466, 577945852, 86657339, 407494833, 604849411, 966944988, 801330989, 451971306, 609232888, 47659834, 896809512, 994536587, 989839281, 951417795, 603854645, 785913529, 768187002, 306378440, 226203351, 952896790, 910078814, 601852748, 468277671, 569904482, 520109000, 443092900, 237917827, 251315171, 895081352, 177233379, 232447676, 215448790, 917264511, 11583959, 592106742, 199303169, 135876151, 571557807, 882365864, 104982756, 935904656, 417654677, 426751352, 627318519, 766403211, 892041049, 881508720, 607642765, 172673071, 803070934, 227347972, 909313199, 157721361, 535054181, 672603138, 349791820, 141494560, 994784732, 789999905, 892146519, 16980279, 134625955, 687523403, 681010849, 518770241, 719253947, 580477776, 435291970, 486362767, 418331810, 20718479, 464165537, 966564556, 407470630, 572686995, 26282610, 618861478, 625082406, 432892546, 640034560, 862007197, 414071410, 913610433, 920560543, 456160460, 762876589, 255937081, 736179553, 369907390, 60441261, 932243728, 314282262, 179199393, 790480747, 400957046, 646058176, 332997666, 509055242, 753760358, 133152612, 397022623, 228550, 802407198, 493029134, 36573414, 571614603, 319764046, 509983754, 493996015, 675406418, 438125701, 107327858, 964655814, 725049626, 35504121, 78510303, 936704532, 635504588, 884899156, 270193834, 736313759, 364005708, 335726402, 57871891, 125811761, 20979223, 145350869, 169344764, 832087925, 473947957, 420470955, 665579758, 396006552, 668386204, 585089701, 184075882, 787512919, 854795440, 123600449, 865901675, 581215748, 424799045, 934853430, 941417173, 343291745, 918614827, 552525207, 793319466, 12};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = malloc(sizeof(in1));
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = malloc(sizeof(in2));
	REQUIRE(tau->num1.num && tau->num2.num);
	memcpy(tau->num1.num, in1, sizeof(in1));
	memcpy(tau->num2.num, in2, sizeof(in2));

	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/******************** REVERSE OF PREVIOUS ********************/

TEST_F(large_multiplications, test_o1kc_times_o1kb)
{
	/* clang-format off */
	u_int in1[] = {120720357, 397122822, 391212010, 378636564, 527381951, 445364023, 899885040, 831438167, 289912154, 386356373, 467962926, 817125772, 778707749, 515723350, 20924616, 454178424, 114657544, 634432190, 904414952, 143603833, 256133844, 201619676, 377306056, 810451660, 815010674, 281198163, 584823824, 739934236, 774447920, 423387184, 43576798, 141865462, 637259085, 182422433, 869987549, 632282216, 515172654, 118746121, 691817195, 100642458, 401797429, 748808428, 97330459, 859095700, 77613379, 824691165, 375014971, 270261896, 971418347, 287776735, 687392807, 72844992, 808489120, 176184502, 298559149, 515082189, 290641249, 784406918, 18525880, 595556264, 662020707, 137836043, 32027777, 282126204, 398571429, 183240048, 893494027, 908475657, 210325195, 41368093, 567494670, 78549187, 829867982, 939611731, 556446171, 260470617, 388185363, 898568742, 584926832, 930685864, 974259747, 196534676, 548532814, 760521395, 176790149, 995282978, 514569063, 129660418, 873623608, 869739334, 116299016, 931525892, 602082336, 842229732, 82941119, 584280220, 738070679, 549296857, 554682269, 129930289, 352088067, 846285574, 807033108, 924619988, 410518654, 524776378, 210726853, 338324773, 234371231, 345598217, 215913853, 40125185, 169659817, 614457144, 263430597, 839552963, 357693985, 358911228, 31559180, 973973025, 529509086, 130265707, 902771569, 939005219, 909614411, 481137671, 453755527, 315076922, 190488385, 858980849, 914750855, 893492457, 44932638, 537640698, 831905869, 686543771, 164968285, 32694655, 549006585, 907130711, 937753741, 473161761, 60159427, 193787354, 490610706, 977776760, 692607694, 6731141, 102078922, 359416565, 975892579, 663415745, 486552688, 501065002, 401362961, 293547871, 954030315, 717222449, 171804201, 933246578, 628660373, 388008411, 546067821, 318550725, 990682255, 492064339, 647433279, 137385221, 703102597, 102835383, 283915020, 951593059, 607687526, 836935402, 684651719, 23912707, 349733186, 901432221, 855504886, 181532375, 353916766, 945868802, 361242525, 362433248, 541955437, 67937107, 539323500, 323672831, 966437313, 515041060, 651866030, 535923932, 530736394, 457121080, 34778553, 656344571, 766040938, 922800831, 880446217, 23307414, 859193718, 316040919, 995023505, 796297454, 417185715, 452307299, 839507981, 32105848, 520365290, 312607239, 836310795, 763091506, 397308051, 361243336, 973440977, 737772666, 670722593, 362707407, 891880855, 294128542, 811056991, 743094473, 39460017, 899096862, 700449819, 26597046, 259465921, 88171879, 774925466, 948922590, 41763507, 818299518, 949483846, 901683400, 91111044, 894870133, 483119139, 879215171, 907094021, 962766583, 741061235, 120204586, 193580405, 293785014, 701801};
	u_int in2[] = {645836236, 108893430, 836208119, 270771001, 537613755, 373039867, 833294108, 898839418, 608485063, 546188873, 452231917, 687296422, 111111152, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 111111111, 476411111, 5669047, 700035645, 893473278, 4493, 543630640, 324000, 568376700, 1394, 300000000, 378345892, 8, 734194700, 423768, 0, 445197384, 518101037, 109617878, 558156514, 983336821, 690076644, 693516675, 143226629, 76588580, 210759419, 973911560, 497333540, 14322213, 555048869, 815323758, 539167661, 458688023, 612425259, 624332483, 419554373, 679371075, 393235000, 236728315, 664373133, 150410609, 518660305, 359239326, 307363945, 571210805, 347785534, 563445710, 660409386, 228008317, 804462179, 233074148, 591937180, 160409198, 950235053, 962974549, 171857157, 523072994, 395079814, 321058488, 203652900, 126072395, 363107953, 630915068, 973080517, 612433363, 734409773, 377726669, 707225937, 627074076, 918808553, 941285428, 110569912, 430944738, 394600177, 990968620, 4498198, 265970467, 594659210, 881718792, 749254660, 489225907, 417635079, 182995180, 494838468, 16834009, 911110449, 948701330, 831191398, 792151714, 70940218, 627665839, 410612359, 202045867, 935804051, 937850141, 227018012, 991791152, 506752363, 406483698, 355792683, 47491630, 22359011, 919962818, 955165934, 399211808, 673319428, 319818160, 662785141, 175882430, 630322415, 735383534, 687650610, 46582669, 496678148, 491637987, 871575195, 116330034, 723314187, 385420689, 325094262, 12829142, 208703866, 120005690, 899921757, 77002169, 359486189, 753454258, 278911354, 694037307, 578519296, 494600786, 470779501, 768446187, 472669563, 716361937, 389127515, 976446119, 593192334, 617083917, 272976737, 418747631, 855714255, 226105187, 605917499, 696971445, 573117854, 99153257, 956645492, 728520292, 946389174, 245482697, 655465609, 470307816, 135416351, 729216591, 866144546, 888959338, 809402688, 527131609, 866613186, 419167460, 916600904, 633154349, 747140489, 315862951, 238759183, 148584074, 652667824, 161606397, 677427537, 590777629, 825244648, 835356427, 366982335, 748040826, 852122159, 4896, 900000000, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 999999999, 385820199, 167580321, 134092496, 277075937, 872169008, 64325722, 827080282, 277960712, 655352740, 163131699, 448213684, 277128786, 514326330, 933871396, 63154105, 745922799, 490015860, 252229607, 711956623, 591788040, 954758766, 467124003, 644524713, 690634208, 510828673, 629041620, 704066384, 468512842, 590156377, 509105852, 101803594, 777808979, 519622805, 972925209, 333284887, 366099858, 584319133, 851605740, 743738793, 912271659, 205902321, 306768696, 951511006, 853007337, 793747247, 858293618, 953587774, 433638706, 827128463, 10931106, 238240138, 541935268, 774418024, 534563619, 736369239, 336516542, 723202909, 72035747, 712282212, 121201039, 863656439, 738195137, 536402352, 988504044, 143816789, 991215483, 635637328, 796292638, 712577246, 870774981, 572335077, 92461651, 417842402, 465754445, 443219011, 441495263, 360383390, 613384414, 161967625, 730605620, 45166037, 501067481, 119816381, 482382428, 993423658, 444792073, 338718477, 357679842, 186546204, 725908514, 242243363, 998754918, 228221686, 517265463, 874612151, 181719511, 64245869, 179742910, 880842840, 733045974, 909570009, 761337985, 469116507, 501497182, 26189637, 141834727, 777673597, 739280728, 284499268, 848912007, 618450280, 855914917, 508218929, 64124951, 440691829, 852588078, 555626401, 202070759, 783604366, 202777713, 212620403, 857142928, 324004839, 349402718, 847565789, 52519590, 658472794, 842462660, 791141310, 195364150, 381999943, 261729562, 18229};
	u_int out[] = {973456252, 412698082, 156854265, 231236880, 474358034, 679091949, 447758531, 493377411, 637994538, 575462518, 915755352, 555293881, 482859668, 676700950, 334034557, 28408988, 482628258, 579259594, 738872206, 871197308, 702265474, 735864594, 157512557, 926743357, 882048537, 11150613, 523219675, 755874332, 581977406, 211329093, 984017167, 57567319, 514051826, 791772321, 792638993, 760554402, 43145462, 193551802, 565360348, 17126266, 472717017, 346875411, 481924938, 7117958, 479017028, 247605729, 209278489, 840696239, 392147532, 53495250, 504210065, 502046351, 714511625, 881956908, 62941673, 916753945, 486652595, 412929118, 54954346, 869595157, 382728091, 722988513, 335328409, 634858740, 256572717, 674203563, 11600175, 418581840, 405046569, 423979357, 951659798, 727308504, 147846721, 768544058, 903047950, 295815064, 868897303, 158285362, 949970028, 326721887, 96356142, 812585111, 896931597, 284906965, 874823497, 905386578, 874287653, 607465176, 624185734, 560032461, 392420655, 8741201, 570521627, 187892696, 989242173, 79457270, 461279755, 178329389, 863762415, 784766683, 31200121, 235831641, 266812872, 199500139, 41723628, 544094501, 857075377, 728444420, 941631074, 404474606, 554179674, 578222996, 797987054, 818738326, 750114941, 50103196, 702184938, 613585960, 665317743, 89904246, 998763247, 339029123, 612595234, 311369789, 959610269, 256630824, 806914657, 793679993, 773620201, 656505563, 994393849, 83683155, 683539241, 804011207, 814146601, 718972641, 845237219, 821538729, 996169319, 35360267, 188778355, 171516559, 708660738, 675157272, 476122012, 900085612, 674772993, 833334730, 10283515, 479131685, 598115734, 369471312, 457491682, 743913010, 156425832, 522883672, 386468073, 772647334, 565053022, 562706849, 445012977, 493314535, 615502660, 322329933, 81383481, 271443191, 643358277, 165941717, 986778798, 752550196, 909173766, 375154039, 511109692, 394859628, 384146192, 507157613, 158454506, 791999371, 324651095, 711961205, 468979783, 254824501, 616886879, 746634373, 489181536, 506140156, 444347759, 634431730, 273551361, 375807327, 502322677, 292149421, 966534332, 57901320, 450439429, 695626107, 163249440, 694453265, 334196451, 109269266, 681332690, 861225219, 7573952, 23684526, 911385340, 921755065, 545439132, 830528350, 584344913, 907999009, 155084801, 713641398, 208952730, 997477963, 408430834, 23929822, 704162858, 155645295, 13570028, 595968323, 792853920, 717155113, 60375533, 875568440, 84416889, 283735593, 613303615, 323997640, 158793785, 806776977, 343428972, 60189921, 693181877, 450069176, 969912778, 533925309, 635186714, 178044482, 417746812, 389330418, 40064830, 116884312, 695388930, 630170261, 336660214, 215980765, 916786927, 748054826, 485554673, 134452359, 308228183, 478022556, 966390076, 439246974, 229665139, 858393286, 978296503, 371719426, 629798177, 679786960, 402143518, 283524678, 451155328, 473585934, 548242332, 584125220, 673950073, 260484559, 739354747, 881533924, 26361124, 116924967, 555237505, 99529654, 896048195, 61934823, 160601585, 68047935, 745268295, 416848656, 869553347, 26234477, 692261965, 808106330, 368939608, 849358439, 670595250, 644257130, 596214304, 463399078, 275448545, 727776118, 587712963, 357837625, 164679319, 951643847, 563042657, 830792179, 898451375, 696965900, 208643746, 981614459, 707936773, 495532392, 636082905, 46998285, 998285197, 667305176, 626063933, 533179955, 852260195, 663445217, 529155749, 115445158, 577011797, 25167443, 204047256, 528091432, 119995549, 195632980, 244146639, 739403804, 941838780, 398481977, 483670969, 492958219, 666322530, 527176054, 986460574, 719557393, 674996087, 382550968, 16803867, 173650919, 740280510, 231187964, 754874386, 950555752, 780118606, 101946412, 535080386, 174433453, 334398158, 115832425, 825054471, 389454401, 725668657, 818920111, 172048484, 655057164, 865548808, 488417742, 543910662, 836247751, 666824852, 156780165, 860772084, 143283360, 58418781, 563326303, 435594916, 229167653, 32831233, 652408171, 839839122, 321889398, 821805902, 551017937, 34299250, 878004560, 944623782, 708591772, 214464763, 277627044, 906269682, 610260566, 767915418, 728864978, 834927805, 999929693, 500994779, 535375840, 23423948, 902176013, 648632566, 128840743, 301398950, 553163152, 323527568, 638326068, 658944113, 60443061, 668747641, 113060422, 448574319, 592719878, 2176602, 388104636, 11280977, 577457862, 728759188, 519861282, 964856560, 142865932, 928150663, 430600900, 668499938, 799275115, 263903, 85263396, 510302143, 959387652, 932233414, 760434309, 877255999, 573782281, 520481225, 652841903, 482562292, 903603164, 723593546, 76083784, 136573214, 967418740, 349005310, 81834840, 683948859, 860511074, 370207012, 424903007, 901105805, 754764642, 849934405, 512138206, 837848485, 87432107, 417398926, 471026245, 599294466, 577945852, 86657339, 407494833, 604849411, 966944988, 801330989, 451971306, 609232888, 47659834, 896809512, 994536587, 989839281, 951417795, 603854645, 785913529, 768187002, 306378440, 226203351, 952896790, 910078814, 601852748, 468277671, 569904482, 520109000, 443092900, 237917827, 251315171, 895081352, 177233379, 232447676, 215448790, 917264511, 11583959, 592106742, 199303169, 135876151, 571557807, 882365864, 104982756, 935904656, 417654677, 426751352, 627318519, 766403211, 892041049, 881508720, 607642765, 172673071, 803070934, 227347972, 909313199, 157721361, 535054181, 672603138, 349791820, 141494560, 994784732, 789999905, 892146519, 16980279, 134625955, 687523403, 681010849, 518770241, 719253947, 580477776, 435291970, 486362767, 418331810, 20718479, 464165537, 966564556, 407470630, 572686995, 26282610, 618861478, 625082406, 432892546, 640034560, 862007197, 414071410, 913610433, 920560543, 456160460, 762876589, 255937081, 736179553, 369907390, 60441261, 932243728, 314282262, 179199393, 790480747, 400957046, 646058176, 332997666, 509055242, 753760358, 133152612, 397022623, 228550, 802407198, 493029134, 36573414, 571614603, 319764046, 509983754, 493996015, 675406418, 438125701, 107327858, 964655814, 725049626, 35504121, 78510303, 936704532, 635504588, 884899156, 270193834, 736313759, 364005708, 335726402, 57871891, 125811761, 20979223, 145350869, 169344764, 832087925, 473947957, 420470955, 665579758, 396006552, 668386204, 585089701, 184075882, 787512919, 854795440, 123600449, 865901675, 581215748, 424799045, 934853430, 941417173, 343291745, 918614827, 552525207, 793319466, 12};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = malloc(sizeof(in1));
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = malloc(sizeof(in2));
	REQUIRE(tau->num1.num && tau->num2.num);
	memcpy(tau->num1.num, in1, sizeof(in1));
	memcpy(tau->num2.num, in2, sizeof(in2));

	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(large_multiplications, test_o500c_times_o500d)
{
	/* clang-format off */
	u_int in1[] = {555555555, 55555555, 0, 0, 0, 0, 222222, 0, 0, 0, 0, 0, 0, 0, 0, 888888888, 888888888, 888888888, 888888888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110000000, 111111111, 111111111, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 770000000, 777777777, 777777777, 777777, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 999000000, 99999999};
	u_int in2[] = {470282653, 363502795, 428381283, 187482382, 467199043, 93190808, 0, 0, 0, 400000000, 133986336, 818672645, 328552829, 467844093, 238950876, 737842756, 975675668, 665546560, 147030781, 113541635, 672921659, 886614454, 888895933, 888888888, 888888888, 888888888, 268888888, 160980940, 318652713, 746086661, 442022266, 249623720, 646946071, 524660960, 229717732, 571794052, 616061544, 679629263, 171257724, 787077498, 157233507, 209246165, 541784240, 146575444, 344321901, 44149526, 436038339, 561338441, 16196762, 773060562, 104516603, 150106748, 411981638, 444444444, 444444444, 444444444, 444444444, 444444444, 444444444, 4};
	u_int out[] = {294287415, 75831780, 177026101, 971593276, 542021713, 458643016, 288781579, 323392264, 745551604, 709987999, 386893910, 59687728, 880490600, 730012872, 52169114, 775827449, 304211339, 140784554, 917261839, 726744766, 627381880, 176393466, 753107174, 225257039, 312755502, 774591122, 391444733, 794137115, 787601054, 497815650, 904572367, 346034109, 789225580, 818484928, 472769027, 459700755, 234944313, 9474951, 66396813, 798295697, 537282204, 385560987, 178114501, 667730617, 309887172, 648486165, 738014897, 465723711, 103389190, 245592126, 321855010, 135634073, 321521982, 385060287, 751325279, 966726173, 898710961, 766861711, 519317447, 355790927, 651476935, 6864796, 107185658, 944506593, 215150947, 245106082, 487662514, 893360024, 766354313, 931665299, 465119474, 166619448, 687943327, 281739217, 664296560, 844889875, 19611252, 79785981, 794177827, 231331982, 906088858, 566537931, 510016717, 342556251, 797501561, 934483127, 256933446, 796722724, 870732331, 946698310, 697978514, 324031829, 359006057, 466459059, 313138659, 379270869, 636354070, 860271637, 678566913, 658638656, 717948827, 82426983, 525815414, 858680557, 398227583, 737007306, 398970894, 579839622, 553031848, 588313222, 295388040, 462978914, 381042495, 694117647, 597846615, 629201539, 172301553, 370598693, 996753719, 999999999, 999999999, 999999999, 999999999, 439999999, 444444444};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = malloc(sizeof(in1));
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = malloc(sizeof(in2));
	REQUIRE(tau->num1.num && tau->num2.num);
	memcpy(tau->num1.num, in1, sizeof(in1));
	memcpy(tau->num2.num, in2, sizeof(in2));

	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/******************** REVERSE OF PREVIOUS ********************/

TEST_F(large_multiplications, test_o500d_times_o500c)
{
	/* clang-format off */
	u_int in1[] = {470282653, 363502795, 428381283, 187482382, 467199043, 93190808, 0, 0, 0, 400000000, 133986336, 818672645, 328552829, 467844093, 238950876, 737842756, 975675668, 665546560, 147030781, 113541635, 672921659, 886614454, 888895933, 888888888, 888888888, 888888888, 268888888, 160980940, 318652713, 746086661, 442022266, 249623720, 646946071, 524660960, 229717732, 571794052, 616061544, 679629263, 171257724, 787077498, 157233507, 209246165, 541784240, 146575444, 344321901, 44149526, 436038339, 561338441, 16196762, 773060562, 104516603, 150106748, 411981638, 444444444, 444444444, 444444444, 444444444, 444444444, 444444444, 4};
	u_int in2[] = {555555555, 55555555, 0, 0, 0, 0, 222222, 0, 0, 0, 0, 0, 0, 0, 0, 888888888, 888888888, 888888888, 888888888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110000000, 111111111, 111111111, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 770000000, 777777777, 777777777, 777777, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 999000000, 99999999};
	u_int out[] = {294287415, 75831780, 177026101, 971593276, 542021713, 458643016, 288781579, 323392264, 745551604, 709987999, 386893910, 59687728, 880490600, 730012872, 52169114, 775827449, 304211339, 140784554, 917261839, 726744766, 627381880, 176393466, 753107174, 225257039, 312755502, 774591122, 391444733, 794137115, 787601054, 497815650, 904572367, 346034109, 789225580, 818484928, 472769027, 459700755, 234944313, 9474951, 66396813, 798295697, 537282204, 385560987, 178114501, 667730617, 309887172, 648486165, 738014897, 465723711, 103389190, 245592126, 321855010, 135634073, 321521982, 385060287, 751325279, 966726173, 898710961, 766861711, 519317447, 355790927, 651476935, 6864796, 107185658, 944506593, 215150947, 245106082, 487662514, 893360024, 766354313, 931665299, 465119474, 166619448, 687943327, 281739217, 664296560, 844889875, 19611252, 79785981, 794177827, 231331982, 906088858, 566537931, 510016717, 342556251, 797501561, 934483127, 256933446, 796722724, 870732331, 946698310, 697978514, 324031829, 359006057, 466459059, 313138659, 379270869, 636354070, 860271637, 678566913, 658638656, 717948827, 82426983, 525815414, 858680557, 398227583, 737007306, 398970894, 579839622, 553031848, 588313222, 295388040, 462978914, 381042495, 694117647, 597846615, 629201539, 172301553, 370598693, 996753719, 999999999, 999999999, 999999999, 999999999, 439999999, 444444444};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = malloc(sizeof(in1));
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = malloc(sizeof(in2));
	REQUIRE(tau->num1.num && tau->num2.num);
	memcpy(tau->num1.num, in1, sizeof(in1));
	memcpy(tau->num2.num, in2, sizeof(in2));

	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(large_multiplications, test_01ka_times_o500d)
{
	/* clang-format off */
	u_int in1[] = {131722372, 802671350, 132456030, 952390804, 989237724, 613862009, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 550000000, 555555555, 5555555, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 704686600, 493821814, 961286928, 322153716, 907156984, 310828945, 194896355, 611171487, 244518098, 231938737, 835448504, 923268737, 730202116, 743009913, 508000968, 332297803, 990517592, 742689628, 777775336, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 7, 0, 0, 770000000, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 277777777, 542504068, 608548869, 501297955, 754021679, 672278000, 394108910, 160276848, 534685744, 968986731, 574146573, 779137604, 495207825, 840417941, 771396240, 727190624, 192915436, 903379804, 815966001, 11429967, 998134182, 658011715, 331591117, 191190811, 538876440, 751789571, 288215636, 653064708, 929084048, 487105239, 747561894, 205340763, 108049215, 943348769, 599175236, 146625093, 513882713, 448788052, 155250407, 757036788, 284348928, 863554107, 870895458, 845801636, 88076479, 511776237, 737629047, 248659873, 10007440, 446125514, 91977716, 635013656, 507882027, 55918320, 910057449, 432505528, 475929634, 210563623, 801688937, 808359103, 847048743, 751924511, 550199911, 414484903, 372540874, 76163220, 246365454, 797583759, 782313811, 908403698, 652790763, 216363355, 817270823, 430517238, 991857751, 509242050, 17653448, 208599291, 2, 0, 0, 0, 0, 0, 0, 38150020, 991025087, 964137894, 722553148, 386553725, 270998143, 214108149, 72979680, 699030993, 741108912, 769903271, 884494557, 344443410, 460990759, 604870008, 747411127, 763756622, 215455806, 947906002, 394543873, 66938617, 453291289, 343664471, 267707914, 12801657, 98078282, 517704826, 328152464, 372850297, 444460873, 733082616, 12135919, 445801394, 307632565, 233661314, 728930684, 786081362, 985690907, 21732050, 657593826, 893221339, 163500612, 978638373, 652309927, 199689309, 25989953, 338175286, 636839646, 197024354, 137856844, 452748236, 325125265, 867759428, 615066855, 38835627, 200200020, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 633947200, 242821496, 675570901, 741469882, 452537907, 306752055, 117156467, 64790695, 936109148, 923919480, 71572279, 127780175, 541780674, 607024435, 151659015, 76280997, 900305055, 115947553, 721595598, 265638460, 746824605, 300469162, 298491605, 914173877, 67186749, 481009887, 587573945, 528153575, 560094623, 540119270, 37348913, 949686895, 795527831, 594244496, 351152626, 610756552, 120269380, 163383012, 314022366, 695481247, 725552300, 991913446, 732889032, 526360583, 553747624, 171293404, 961349798, 681146714, 947647065, 478946176, 914243491, 6421, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 988930000, 720804333, 77333122, 71478584, 802684893, 401413936, 252647494, 126498088, 436860660, 107501624, 604750710, 240569256, 974986253, 393455345, 927377743, 883926285, 725490027, 521497397, 43440187, 587245338, 458714971, 303019637, 164322731, 249451002, 358513673, 681348956, 451033021, 9243032, 772070369, 995255942, 736472255, 868092699, 47844500, 402409083, 179114254, 103854738, 46678400, 975293712, 970263719, 227914876, 351954049, 53574475, 546838129, 106382550, 115071819, 953092174, 478315368, 839263241, 725645322, 712617862, 494890866, 988367455, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 900006969, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 900006969, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 400006969, 809831282, 815548241, 358691851, 750590059, 713284541, 242757159, 135763073, 800021608, 963509516, 617674215, 969293784, 543338850, 815839627, 329448516, 715893385, 546356108, 416921673, 811412819, 328849343, 433639289, 675346056, 174270126, 820768601, 272567424, 614766610, 926369886, 872483144, 48081452, 432681564, 413915422, 662105764, 501705254, 138793308, 185469394, 180166149, 938114739, 466973496, 153808103, 526512203, 804554714, 944267973, 392374639, 842917453, 522394895, 436346971, 731892979, 642512104, 182859113, 454902339, 581768582, 324506047, 745918758, 897170174, 291468302, 977505750, 410568508, 772999686, 794321635, 651501887, 13705574, 584502763, 502268927, 124900578, 898499355, 295985307, 994672920, 144303481, 483827006, 479174491, 601463221, 449315155, 330964919, 414976947, 499819035, 187476700, 409345714, 963262468, 554461954, 310645478, 67661, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 300000000, 30030300, 300303003, 3030030, 30300303, 303003030, 30030300, 300303003, 3030030, 30300303, 303003030, 30030300, 300303003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 883622300, 669036119, 257383897, 331456055, 118354160, 973212098, 416973417, 946211525, 34594243, 378049694, 763505821, 662821050, 260614049, 474325353, 205921824, 137791970, 285519667, 52875193, 175072700, 655963181, 195226513, 168040379, 521765067, 568092616, 626968098, 581716135, 539546681, 728767378, 274895502, 67154633, 904763988, 171571554, 92723870, 967521185, 521690465, 446978893, 542837448, 569900378, 449749871, 641825348, 434944573, 4151211, 257502333, 350176088, 377226305, 724682903, 86738505, 259, 0, 0, 664000000, 384223576, 77655806, 268984277, 780855518, 712631072, 138232294, 75560405, 633173102, 447937331, 178093477, 735473623, 762909654, 921045167, 721115470, 118241925, 917412737, 880844525, 26813784, 562486098, 665936206, 396781083, 444444444, 251374444, 631433554, 209806566, 574570611, 969158830, 824815872, 812322502, 864428317, 697192749, 538976626, 445919938, 464135710, 949958051, 310266626, 291115780, 240001431, 226295236, 586757103, 132965817, 986975387, 50951661, 498234569, 142562459, 419584631, 928710596, 359565797, 152657460, 461226973, 768458971, 806567179, 288617868, 640884118, 904389073, 596236969, 423167529, 380552886, 758691524, 600776015, 666040080, 952913710, 648043789, 312329803, 93585288, 617508735, 741105041, 894446968, 849189884, 483140175, 184746334, 951426677, 5925686, 789847384, 608938721, 834748828, 539460124, 181872517, 375579811, 900880777, 43682854, 808557000, 656612977, 335726184, 954205271, 921294654, 644901719, 812362076, 493260187, 363741916, 944100391, 1536, 0, 0, 0, 0, 0, 0, 0, 62521150, 753424331, 300713482, 94569828, 592280290, 1006033, 577014246, 235920452, 371466402, 54856595, 860766560, 155851058, 794978558, 243852131, 154683303, 927434388, 234567899, 654321001, 456789987, 432100123, 678998765, 210012345, 899876543, 1234567, 987654321, 123456789, 765432100, 345678998, 543210012, 567899876, 321001234, 789987654, 100123456, 998765432, 12345678, 876543210, 234567899, 654321001, 456789987, 432100123, 678998765, 210012345, 899876543, 1234567, 987654321, 123456789, 765432100, 345678998, 543210012, 567899876, 321001234, 789987654, 100123456, 998765432, 12345678, 876543210, 234567899, 654321001, 456789987, 432100123, 134898765, 350620171, 356474814, 627};
	u_int in2[] = {555555555, 55555555, 0, 0, 0, 0, 222222, 0, 0, 0, 0, 0, 0, 0, 0, 888888888, 888888888, 888888888, 888888888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110000000, 111111111, 111111111, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 770000000, 777777777, 777777777, 777777, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 999000000, 99999999};
	u_int out[] = {482376460, 887404805, 44842336, 71042406, 13337710, 489653928, 275019334, 433539083, 644077032, 189275922, 385714370, 643583828, 4803075, 0, 0, 771802336, 619847688, 548927972, 625652618, 151344377, 473077438, 759713983, 957989356, 657100199, 312321786, 666665451, 566666666, 1234, 0, 920000000, 610964752, 965774809, 297894159, 335758469, 212410442, 681135674, 137524994, 140223332, 604940673, 4938271, 0, 0, 0, 0, 0, 604063000, 780185595, 821080184, 377263377, 788173076, 347027625, 382359546, 319060563, 819910682, 231867136, 955482985, 418864677, 731949179, 610959068, 559253595, 564792744, 687600541, 154615416, 533621631, 329737047, 349483491, 879386909, 473949928, 795248962, 568482649, 963485777, 217299755, 12725319, 767936732, 68842253, 64524512, 514726442, 502172156, 424488691, 807113014, 811391909, 481129, 315868296, 169328903, 124907534, 571077125, 752722728, 367911356, 953478637, 907448545, 231843416, 174513817, 91633108, 83613833, 762470362, 266069537, 904786899, 533574207, 190952010, 431117726, 952680951, 893531249, 886231423, 285389935, 705870827, 619211423, 461674747, 997120784, 808309994, 151567114, 489324982, 285367300, 774396201, 593781847, 375197103, 124293758, 932776887, 509767352, 512761519, 350927487, 329374485, 893570474, 646590428, 3084618, 29544800, 403859399, 745109843, 133845285, 757332214, 305083909, 649351210, 7079290, 256619086, 34372417, 700328382, 539044515, 309956545, 636798647, 473605936, 586753562, 234778207, 776102340, 836130424, 867673754, 193914275, 726929714, 566596853, 839254486, 837770876, 928559917, 83178284, 260985640, 229411226, 221519941, 224967510, 454175882, 5608737, 977994346, 646799625, 447856669, 301761745, 668640006, 953005395, 200239564, 82868051, 146265337, 570432041, 126164180, 737601746, 271948694, 830290830, 95925803, 191538832, 435743767, 76519849, 899963882, 109819064, 572874668, 561205545, 375138552, 836650833, 162823123, 681315643, 8208370, 202755776, 184893841, 663398535, 448192645, 803003669, 215641617, 139659870, 861890295, 211531847, 175801412, 800119462, 357640315, 862514267, 989556360, 965551483, 960396339, 34298165, 838469703, 17427311, 205861249, 577662589, 171001878, 194944876, 239145608, 333758359, 6583137, 607779473, 339937909, 443507068, 821478619, 711258154, 389417574, 152635396, 193997969, 142153652, 824808827, 603110773, 950222077, 762356915, 383591573, 255148713, 788779891, 60854506, 239576878, 395973366, 718127717, 254645865, 911733837, 31119134, 474894619, 27328498, 459139022, 756661066, 134454068, 389357055, 50677097, 859418938, 826031295, 364741900, 651008154, 444631273, 108640567, 2155479, 381707213, 880213915, 986111454, 433236125, 236231242, 143922210, 542248704, 408574040, 207159364, 575726432, 939385384, 711637484, 807330580, 883610354, 441046150, 47677447, 441506702, 456258418, 470753750, 316823814, 221929425, 180118892, 786280657, 137350928, 548054183, 201906138, 348805516, 648358202, 103281998, 835654656, 973002229, 879745385, 83116112, 358634576, 359730845, 160830823, 513472140, 178056058, 20982158, 4024625, 12923563, 570704680, 867677257, 336032785, 748910963, 124720914, 585743679, 328751184, 739351668, 792226065, 500063009, 407827887, 157815511, 859067639, 787228710, 819195644, 508718590, 144269645, 849953657, 268570017, 582696372, 411121093, 795205928, 680577816, 368840225, 986835658, 34518749, 547406736, 414913364, 383885788, 644759940, 88415342, 430868176, 349792321, 601919060, 579684795, 996855038, 869274911, 674581224, 322666608, 651898, 171546527, 206363934, 306675636, 6277655, 559380198, 126049693, 633841398, 965790604, 89276765, 377676175, 276013263, 38008542, 418707634, 649872018, 871255660, 148447590, 583267419, 649015632, 971149188, 897637263, 415554746, 870016153, 590028170, 681206226, 900849719, 857368850, 786335297, 312318130, 775512163, 998093576, 98006694, 935718322, 894096546, 396265855, 184558726, 430509891, 951050940, 8368021, 14283872, 349254753, 476333155, 509857482, 906268782, 476655264, 974019481, 444644815, 320502878, 47024523, 624032118, 369200537, 118158656, 129372748, 153529390, 347202305, 260781117, 744628122, 690108736, 819800714, 471368555, 312019908, 417644356, 364288495, 140309305, 306702742, 341309211, 126499166, 142079806, 406233578, 149686050, 448724731, 811644398, 303601213, 498711511, 385971623, 956901989, 356873122, 777108752, 556550702, 867708198, 35581411, 5905625, 298635502, 312876814, 720575542, 803478761, 169473059, 694249908, 512754497, 677096690, 398284768, 249645311, 679131816, 653021359, 533693952, 154611495, 175963591, 247888614, 770953645, 888977220, 38943755, 212015367, 876907691, 232668044, 411688612, 573964066, 421464368, 13126580, 918362819, 262949292, 354997302, 216807838, 190549040, 674563352, 654311382, 379902124, 744786392, 236806533, 420838257, 612629752, 719092923, 984337160, 144304430, 817285663, 574176710, 770747516, 985400975, 773889352, 519208182, 160618305, 988491657, 304686349, 423606113, 814943815, 961269944, 252589083, 165156268, 800849422, 679203128, 311257145, 897607443, 165785615, 556378809, 30774586, 735906498, 741525902, 289080448, 308542052, 784233171, 778846715, 720037375, 797542036, 656791096, 323601478, 557417691, 548751749, 866629775, 60039757, 253940766, 94854879, 264194922, 538057046, 495231289, 287047801, 313651667, 447754427, 577470295, 251168700, 807321013, 776365039, 614571030, 879074205, 521637446, 621570893, 966869074, 2243463, 280558486, 540127929, 92424028, 985428185, 17691758, 582534592, 725649650, 118944992, 465833494, 289082973, 852573470, 40500095, 152728081, 444536445, 531649996, 858217933, 315443821, 8891415, 342013575, 849626556, 550819903, 536044522, 227758842, 550089268, 728964787, 389049464, 977562650, 944237988, 753454334, 383499073, 927520049, 192308815, 490236039, 34979079, 541714586, 402822419, 248816055, 654431389, 476642721, 998525550, 448866409, 7395122, 457902301, 696079652, 684261099, 565891721, 376454364, 355174126, 273417272, 598355449, 909370162, 686095681, 246238244, 953774478, 220495816, 61300449, 966339763, 29999, 287176503, 186868852, 102766040, 319696087, 337465683, 366929729, 203785073, 380805125, 201790307, 506751139, 176302848, 513859156, 339964694, 711788059, 99820069, 889231347, 39767473, 579136184, 733640502, 746203135, 256334430, 143886736, 224985813, 511486242, 569610279, 306194578, 4549283, 307030505, 357321833, 398460088, 562024913, 489433989, 772987764, 742405227, 21574000, 368025482, 524052964, 709464832, 196436206, 677558244, 238707037, 714288707, 797158808, 831743655, 598334984, 688573246, 731888603, 965432178, 936815556, 210596468, 669903920, 361726638, 374120870, 622908895, 91996338, 432526052, 359348977, 108007478, 714359727, 200541689, 157374763, 373234128, 115917833, 237677439, 565278704, 597050733, 97377448, 60392675, 837455156, 57820973, 968071946, 108340154, 525723893, 508276353, 427540104, 468459662, 199578471, 979555274, 176779641, 2981825, 759209750, 824753775, 809078204, 899877699, 511274322, 141735473, 303986766, 491712611, 39485204, 461937744, 793401328, 526006841, 814206020, 954169432, 812453849, 474175579, 881380155, 557609511, 730030651, 276808165, 183756910, 304974502, 329302229, 272137958, 325965129, 341947852, 738065773, 82534713, 429911184, 705547566, 628034741, 875422591, 662700437, 337965362, 11747162, 804093955, 876766635, 730003712, 634318167, 736645003, 672135043, 713157126, 691745698, 473734701, 830511751, 588366947, 891325485, 923773159, 455670277, 61756582, 667222672, 288281138, 533659968, 245451482, 433315028, 201314767, 215682374, 272834418, 935146854, 963435652, 461236461, 749584449, 961307816, 110865104, 144541865, 654384925, 422919471, 110919513, 752453889, 480662502, 253782455, 241058124, 616216496, 944306640, 650550146, 921302707, 577585145, 291579573, 650974727, 914073126, 257196451, 291820169, 689414920, 147464351, 644170410, 78352262, 207467986, 810547657, 58368740, 799912787, 762329775, 246820881, 210040116, 560639495, 384703183, 767888466, 100500788, 709071624, 795687627, 373567609, 302451146, 281151014, 102094615, 805669211, 725223598, 825240903, 450074631, 205180400, 863311805, 248084390, 349881917, 923116792, 117467508, 794634726, 298018556, 790918327, 743560524, 572611327, 808275816, 373593701, 256602883, 757452094, 888246691, 591427801, 254167438, 77522152, 219096800, 614483897, 317221824, 842484478, 498079693, 662784903, 897406410, 800403947, 835030161, 350406612, 818607699, 746140093, 251887054, 458120585, 684792301, 431870805, 11993338, 62942236, 629875212, 457990608, 259056692, 50052118, 822746298, 543213120, 912033053, 460077539, 952114686, 478858711, 211412880, 885871195, 141288047, 587119521, 128804788, 711952114, 185527858, 227277404, 81822984, 500901043, 177270195, 977161474, 229082320, 709176790, 908232097, 917679022, 823209770, 767902290, 320977091, 790229082, 97709176, 22908232, 906260679, 515285148, 629327693, 221018496, 754248013, 501524171, 864197531, 358024689, 419753101, 802468986, 975310135, 246898641, 531013580, 689864197, 101358024, 986419753, 135802468, 641975310, 580246898, 372075113, 299139256, 807705542, 735647480, 62};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = malloc(sizeof(in1));
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = malloc(sizeof(in2));
	REQUIRE(tau->num1.num && tau->num2.num);
	memcpy(tau->num1.num, in1, sizeof(in1));
	memcpy(tau->num2.num, in2, sizeof(in2));

	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/******************** REVERSE OF PREVIOUS ********************/

TEST_F(large_multiplications, test_o500d_times_o1ka)
{
	/* clang-format off */
	u_int in1[] = {131722372, 802671350, 132456030, 952390804, 989237724, 613862009, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 550000000, 555555555, 5555555, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 704686600, 493821814, 961286928, 322153716, 907156984, 310828945, 194896355, 611171487, 244518098, 231938737, 835448504, 923268737, 730202116, 743009913, 508000968, 332297803, 990517592, 742689628, 777775336, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 7, 0, 0, 770000000, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 277777777, 542504068, 608548869, 501297955, 754021679, 672278000, 394108910, 160276848, 534685744, 968986731, 574146573, 779137604, 495207825, 840417941, 771396240, 727190624, 192915436, 903379804, 815966001, 11429967, 998134182, 658011715, 331591117, 191190811, 538876440, 751789571, 288215636, 653064708, 929084048, 487105239, 747561894, 205340763, 108049215, 943348769, 599175236, 146625093, 513882713, 448788052, 155250407, 757036788, 284348928, 863554107, 870895458, 845801636, 88076479, 511776237, 737629047, 248659873, 10007440, 446125514, 91977716, 635013656, 507882027, 55918320, 910057449, 432505528, 475929634, 210563623, 801688937, 808359103, 847048743, 751924511, 550199911, 414484903, 372540874, 76163220, 246365454, 797583759, 782313811, 908403698, 652790763, 216363355, 817270823, 430517238, 991857751, 509242050, 17653448, 208599291, 2, 0, 0, 0, 0, 0, 0, 38150020, 991025087, 964137894, 722553148, 386553725, 270998143, 214108149, 72979680, 699030993, 741108912, 769903271, 884494557, 344443410, 460990759, 604870008, 747411127, 763756622, 215455806, 947906002, 394543873, 66938617, 453291289, 343664471, 267707914, 12801657, 98078282, 517704826, 328152464, 372850297, 444460873, 733082616, 12135919, 445801394, 307632565, 233661314, 728930684, 786081362, 985690907, 21732050, 657593826, 893221339, 163500612, 978638373, 652309927, 199689309, 25989953, 338175286, 636839646, 197024354, 137856844, 452748236, 325125265, 867759428, 615066855, 38835627, 200200020, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 633947200, 242821496, 675570901, 741469882, 452537907, 306752055, 117156467, 64790695, 936109148, 923919480, 71572279, 127780175, 541780674, 607024435, 151659015, 76280997, 900305055, 115947553, 721595598, 265638460, 746824605, 300469162, 298491605, 914173877, 67186749, 481009887, 587573945, 528153575, 560094623, 540119270, 37348913, 949686895, 795527831, 594244496, 351152626, 610756552, 120269380, 163383012, 314022366, 695481247, 725552300, 991913446, 732889032, 526360583, 553747624, 171293404, 961349798, 681146714, 947647065, 478946176, 914243491, 6421, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 988930000, 720804333, 77333122, 71478584, 802684893, 401413936, 252647494, 126498088, 436860660, 107501624, 604750710, 240569256, 974986253, 393455345, 927377743, 883926285, 725490027, 521497397, 43440187, 587245338, 458714971, 303019637, 164322731, 249451002, 358513673, 681348956, 451033021, 9243032, 772070369, 995255942, 736472255, 868092699, 47844500, 402409083, 179114254, 103854738, 46678400, 975293712, 970263719, 227914876, 351954049, 53574475, 546838129, 106382550, 115071819, 953092174, 478315368, 839263241, 725645322, 712617862, 494890866, 988367455, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 900006969, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 900006969, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 400006969, 809831282, 815548241, 358691851, 750590059, 713284541, 242757159, 135763073, 800021608, 963509516, 617674215, 969293784, 543338850, 815839627, 329448516, 715893385, 546356108, 416921673, 811412819, 328849343, 433639289, 675346056, 174270126, 820768601, 272567424, 614766610, 926369886, 872483144, 48081452, 432681564, 413915422, 662105764, 501705254, 138793308, 185469394, 180166149, 938114739, 466973496, 153808103, 526512203, 804554714, 944267973, 392374639, 842917453, 522394895, 436346971, 731892979, 642512104, 182859113, 454902339, 581768582, 324506047, 745918758, 897170174, 291468302, 977505750, 410568508, 772999686, 794321635, 651501887, 13705574, 584502763, 502268927, 124900578, 898499355, 295985307, 994672920, 144303481, 483827006, 479174491, 601463221, 449315155, 330964919, 414976947, 499819035, 187476700, 409345714, 963262468, 554461954, 310645478, 67661, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 300000000, 30030300, 300303003, 3030030, 30300303, 303003030, 30030300, 300303003, 3030030, 30300303, 303003030, 30030300, 300303003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 883622300, 669036119, 257383897, 331456055, 118354160, 973212098, 416973417, 946211525, 34594243, 378049694, 763505821, 662821050, 260614049, 474325353, 205921824, 137791970, 285519667, 52875193, 175072700, 655963181, 195226513, 168040379, 521765067, 568092616, 626968098, 581716135, 539546681, 728767378, 274895502, 67154633, 904763988, 171571554, 92723870, 967521185, 521690465, 446978893, 542837448, 569900378, 449749871, 641825348, 434944573, 4151211, 257502333, 350176088, 377226305, 724682903, 86738505, 259, 0, 0, 664000000, 384223576, 77655806, 268984277, 780855518, 712631072, 138232294, 75560405, 633173102, 447937331, 178093477, 735473623, 762909654, 921045167, 721115470, 118241925, 917412737, 880844525, 26813784, 562486098, 665936206, 396781083, 444444444, 251374444, 631433554, 209806566, 574570611, 969158830, 824815872, 812322502, 864428317, 697192749, 538976626, 445919938, 464135710, 949958051, 310266626, 291115780, 240001431, 226295236, 586757103, 132965817, 986975387, 50951661, 498234569, 142562459, 419584631, 928710596, 359565797, 152657460, 461226973, 768458971, 806567179, 288617868, 640884118, 904389073, 596236969, 423167529, 380552886, 758691524, 600776015, 666040080, 952913710, 648043789, 312329803, 93585288, 617508735, 741105041, 894446968, 849189884, 483140175, 184746334, 951426677, 5925686, 789847384, 608938721, 834748828, 539460124, 181872517, 375579811, 900880777, 43682854, 808557000, 656612977, 335726184, 954205271, 921294654, 644901719, 812362076, 493260187, 363741916, 944100391, 1536, 0, 0, 0, 0, 0, 0, 0, 62521150, 753424331, 300713482, 94569828, 592280290, 1006033, 577014246, 235920452, 371466402, 54856595, 860766560, 155851058, 794978558, 243852131, 154683303, 927434388, 234567899, 654321001, 456789987, 432100123, 678998765, 210012345, 899876543, 1234567, 987654321, 123456789, 765432100, 345678998, 543210012, 567899876, 321001234, 789987654, 100123456, 998765432, 12345678, 876543210, 234567899, 654321001, 456789987, 432100123, 678998765, 210012345, 899876543, 1234567, 987654321, 123456789, 765432100, 345678998, 543210012, 567899876, 321001234, 789987654, 100123456, 998765432, 12345678, 876543210, 234567899, 654321001, 456789987, 432100123, 134898765, 350620171, 356474814, 627};
	u_int in2[] = {555555555, 55555555, 0, 0, 0, 0, 222222, 0, 0, 0, 0, 0, 0, 0, 0, 888888888, 888888888, 888888888, 888888888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110000000, 111111111, 111111111, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 770000000, 777777777, 777777777, 777777, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 999000000, 99999999};
	u_int out[] = {482376460, 887404805, 44842336, 71042406, 13337710, 489653928, 275019334, 433539083, 644077032, 189275922, 385714370, 643583828, 4803075, 0, 0, 771802336, 619847688, 548927972, 625652618, 151344377, 473077438, 759713983, 957989356, 657100199, 312321786, 666665451, 566666666, 1234, 0, 920000000, 610964752, 965774809, 297894159, 335758469, 212410442, 681135674, 137524994, 140223332, 604940673, 4938271, 0, 0, 0, 0, 0, 604063000, 780185595, 821080184, 377263377, 788173076, 347027625, 382359546, 319060563, 819910682, 231867136, 955482985, 418864677, 731949179, 610959068, 559253595, 564792744, 687600541, 154615416, 533621631, 329737047, 349483491, 879386909, 473949928, 795248962, 568482649, 963485777, 217299755, 12725319, 767936732, 68842253, 64524512, 514726442, 502172156, 424488691, 807113014, 811391909, 481129, 315868296, 169328903, 124907534, 571077125, 752722728, 367911356, 953478637, 907448545, 231843416, 174513817, 91633108, 83613833, 762470362, 266069537, 904786899, 533574207, 190952010, 431117726, 952680951, 893531249, 886231423, 285389935, 705870827, 619211423, 461674747, 997120784, 808309994, 151567114, 489324982, 285367300, 774396201, 593781847, 375197103, 124293758, 932776887, 509767352, 512761519, 350927487, 329374485, 893570474, 646590428, 3084618, 29544800, 403859399, 745109843, 133845285, 757332214, 305083909, 649351210, 7079290, 256619086, 34372417, 700328382, 539044515, 309956545, 636798647, 473605936, 586753562, 234778207, 776102340, 836130424, 867673754, 193914275, 726929714, 566596853, 839254486, 837770876, 928559917, 83178284, 260985640, 229411226, 221519941, 224967510, 454175882, 5608737, 977994346, 646799625, 447856669, 301761745, 668640006, 953005395, 200239564, 82868051, 146265337, 570432041, 126164180, 737601746, 271948694, 830290830, 95925803, 191538832, 435743767, 76519849, 899963882, 109819064, 572874668, 561205545, 375138552, 836650833, 162823123, 681315643, 8208370, 202755776, 184893841, 663398535, 448192645, 803003669, 215641617, 139659870, 861890295, 211531847, 175801412, 800119462, 357640315, 862514267, 989556360, 965551483, 960396339, 34298165, 838469703, 17427311, 205861249, 577662589, 171001878, 194944876, 239145608, 333758359, 6583137, 607779473, 339937909, 443507068, 821478619, 711258154, 389417574, 152635396, 193997969, 142153652, 824808827, 603110773, 950222077, 762356915, 383591573, 255148713, 788779891, 60854506, 239576878, 395973366, 718127717, 254645865, 911733837, 31119134, 474894619, 27328498, 459139022, 756661066, 134454068, 389357055, 50677097, 859418938, 826031295, 364741900, 651008154, 444631273, 108640567, 2155479, 381707213, 880213915, 986111454, 433236125, 236231242, 143922210, 542248704, 408574040, 207159364, 575726432, 939385384, 711637484, 807330580, 883610354, 441046150, 47677447, 441506702, 456258418, 470753750, 316823814, 221929425, 180118892, 786280657, 137350928, 548054183, 201906138, 348805516, 648358202, 103281998, 835654656, 973002229, 879745385, 83116112, 358634576, 359730845, 160830823, 513472140, 178056058, 20982158, 4024625, 12923563, 570704680, 867677257, 336032785, 748910963, 124720914, 585743679, 328751184, 739351668, 792226065, 500063009, 407827887, 157815511, 859067639, 787228710, 819195644, 508718590, 144269645, 849953657, 268570017, 582696372, 411121093, 795205928, 680577816, 368840225, 986835658, 34518749, 547406736, 414913364, 383885788, 644759940, 88415342, 430868176, 349792321, 601919060, 579684795, 996855038, 869274911, 674581224, 322666608, 651898, 171546527, 206363934, 306675636, 6277655, 559380198, 126049693, 633841398, 965790604, 89276765, 377676175, 276013263, 38008542, 418707634, 649872018, 871255660, 148447590, 583267419, 649015632, 971149188, 897637263, 415554746, 870016153, 590028170, 681206226, 900849719, 857368850, 786335297, 312318130, 775512163, 998093576, 98006694, 935718322, 894096546, 396265855, 184558726, 430509891, 951050940, 8368021, 14283872, 349254753, 476333155, 509857482, 906268782, 476655264, 974019481, 444644815, 320502878, 47024523, 624032118, 369200537, 118158656, 129372748, 153529390, 347202305, 260781117, 744628122, 690108736, 819800714, 471368555, 312019908, 417644356, 364288495, 140309305, 306702742, 341309211, 126499166, 142079806, 406233578, 149686050, 448724731, 811644398, 303601213, 498711511, 385971623, 956901989, 356873122, 777108752, 556550702, 867708198, 35581411, 5905625, 298635502, 312876814, 720575542, 803478761, 169473059, 694249908, 512754497, 677096690, 398284768, 249645311, 679131816, 653021359, 533693952, 154611495, 175963591, 247888614, 770953645, 888977220, 38943755, 212015367, 876907691, 232668044, 411688612, 573964066, 421464368, 13126580, 918362819, 262949292, 354997302, 216807838, 190549040, 674563352, 654311382, 379902124, 744786392, 236806533, 420838257, 612629752, 719092923, 984337160, 144304430, 817285663, 574176710, 770747516, 985400975, 773889352, 519208182, 160618305, 988491657, 304686349, 423606113, 814943815, 961269944, 252589083, 165156268, 800849422, 679203128, 311257145, 897607443, 165785615, 556378809, 30774586, 735906498, 741525902, 289080448, 308542052, 784233171, 778846715, 720037375, 797542036, 656791096, 323601478, 557417691, 548751749, 866629775, 60039757, 253940766, 94854879, 264194922, 538057046, 495231289, 287047801, 313651667, 447754427, 577470295, 251168700, 807321013, 776365039, 614571030, 879074205, 521637446, 621570893, 966869074, 2243463, 280558486, 540127929, 92424028, 985428185, 17691758, 582534592, 725649650, 118944992, 465833494, 289082973, 852573470, 40500095, 152728081, 444536445, 531649996, 858217933, 315443821, 8891415, 342013575, 849626556, 550819903, 536044522, 227758842, 550089268, 728964787, 389049464, 977562650, 944237988, 753454334, 383499073, 927520049, 192308815, 490236039, 34979079, 541714586, 402822419, 248816055, 654431389, 476642721, 998525550, 448866409, 7395122, 457902301, 696079652, 684261099, 565891721, 376454364, 355174126, 273417272, 598355449, 909370162, 686095681, 246238244, 953774478, 220495816, 61300449, 966339763, 29999, 287176503, 186868852, 102766040, 319696087, 337465683, 366929729, 203785073, 380805125, 201790307, 506751139, 176302848, 513859156, 339964694, 711788059, 99820069, 889231347, 39767473, 579136184, 733640502, 746203135, 256334430, 143886736, 224985813, 511486242, 569610279, 306194578, 4549283, 307030505, 357321833, 398460088, 562024913, 489433989, 772987764, 742405227, 21574000, 368025482, 524052964, 709464832, 196436206, 677558244, 238707037, 714288707, 797158808, 831743655, 598334984, 688573246, 731888603, 965432178, 936815556, 210596468, 669903920, 361726638, 374120870, 622908895, 91996338, 432526052, 359348977, 108007478, 714359727, 200541689, 157374763, 373234128, 115917833, 237677439, 565278704, 597050733, 97377448, 60392675, 837455156, 57820973, 968071946, 108340154, 525723893, 508276353, 427540104, 468459662, 199578471, 979555274, 176779641, 2981825, 759209750, 824753775, 809078204, 899877699, 511274322, 141735473, 303986766, 491712611, 39485204, 461937744, 793401328, 526006841, 814206020, 954169432, 812453849, 474175579, 881380155, 557609511, 730030651, 276808165, 183756910, 304974502, 329302229, 272137958, 325965129, 341947852, 738065773, 82534713, 429911184, 705547566, 628034741, 875422591, 662700437, 337965362, 11747162, 804093955, 876766635, 730003712, 634318167, 736645003, 672135043, 713157126, 691745698, 473734701, 830511751, 588366947, 891325485, 923773159, 455670277, 61756582, 667222672, 288281138, 533659968, 245451482, 433315028, 201314767, 215682374, 272834418, 935146854, 963435652, 461236461, 749584449, 961307816, 110865104, 144541865, 654384925, 422919471, 110919513, 752453889, 480662502, 253782455, 241058124, 616216496, 944306640, 650550146, 921302707, 577585145, 291579573, 650974727, 914073126, 257196451, 291820169, 689414920, 147464351, 644170410, 78352262, 207467986, 810547657, 58368740, 799912787, 762329775, 246820881, 210040116, 560639495, 384703183, 767888466, 100500788, 709071624, 795687627, 373567609, 302451146, 281151014, 102094615, 805669211, 725223598, 825240903, 450074631, 205180400, 863311805, 248084390, 349881917, 923116792, 117467508, 794634726, 298018556, 790918327, 743560524, 572611327, 808275816, 373593701, 256602883, 757452094, 888246691, 591427801, 254167438, 77522152, 219096800, 614483897, 317221824, 842484478, 498079693, 662784903, 897406410, 800403947, 835030161, 350406612, 818607699, 746140093, 251887054, 458120585, 684792301, 431870805, 11993338, 62942236, 629875212, 457990608, 259056692, 50052118, 822746298, 543213120, 912033053, 460077539, 952114686, 478858711, 211412880, 885871195, 141288047, 587119521, 128804788, 711952114, 185527858, 227277404, 81822984, 500901043, 177270195, 977161474, 229082320, 709176790, 908232097, 917679022, 823209770, 767902290, 320977091, 790229082, 97709176, 22908232, 906260679, 515285148, 629327693, 221018496, 754248013, 501524171, 864197531, 358024689, 419753101, 802468986, 975310135, 246898641, 531013580, 689864197, 101358024, 986419753, 135802468, 641975310, 580246898, 372075113, 299139256, 807705542, 735647480, 62};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = malloc(sizeof(in1));
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = malloc(sizeof(in2));
	REQUIRE(tau->num1.num && tau->num2.num);
	memcpy(tau->num1.num, in1, sizeof(in1));
	memcpy(tau->num2.num, in2, sizeof(in2));

	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(large_multiplications, test_01ka_times_0)
{
	/* clang-format off */
	u_int in1[] = {131722372, 802671350, 132456030, 952390804, 989237724, 613862009, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 550000000, 555555555, 5555555, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 704686600, 493821814, 961286928, 322153716, 907156984, 310828945, 194896355, 611171487, 244518098, 231938737, 835448504, 923268737, 730202116, 743009913, 508000968, 332297803, 990517592, 742689628, 777775336, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 7, 0, 0, 770000000, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 277777777, 542504068, 608548869, 501297955, 754021679, 672278000, 394108910, 160276848, 534685744, 968986731, 574146573, 779137604, 495207825, 840417941, 771396240, 727190624, 192915436, 903379804, 815966001, 11429967, 998134182, 658011715, 331591117, 191190811, 538876440, 751789571, 288215636, 653064708, 929084048, 487105239, 747561894, 205340763, 108049215, 943348769, 599175236, 146625093, 513882713, 448788052, 155250407, 757036788, 284348928, 863554107, 870895458, 845801636, 88076479, 511776237, 737629047, 248659873, 10007440, 446125514, 91977716, 635013656, 507882027, 55918320, 910057449, 432505528, 475929634, 210563623, 801688937, 808359103, 847048743, 751924511, 550199911, 414484903, 372540874, 76163220, 246365454, 797583759, 782313811, 908403698, 652790763, 216363355, 817270823, 430517238, 991857751, 509242050, 17653448, 208599291, 2, 0, 0, 0, 0, 0, 0, 38150020, 991025087, 964137894, 722553148, 386553725, 270998143, 214108149, 72979680, 699030993, 741108912, 769903271, 884494557, 344443410, 460990759, 604870008, 747411127, 763756622, 215455806, 947906002, 394543873, 66938617, 453291289, 343664471, 267707914, 12801657, 98078282, 517704826, 328152464, 372850297, 444460873, 733082616, 12135919, 445801394, 307632565, 233661314, 728930684, 786081362, 985690907, 21732050, 657593826, 893221339, 163500612, 978638373, 652309927, 199689309, 25989953, 338175286, 636839646, 197024354, 137856844, 452748236, 325125265, 867759428, 615066855, 38835627, 200200020, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 633947200, 242821496, 675570901, 741469882, 452537907, 306752055, 117156467, 64790695, 936109148, 923919480, 71572279, 127780175, 541780674, 607024435, 151659015, 76280997, 900305055, 115947553, 721595598, 265638460, 746824605, 300469162, 298491605, 914173877, 67186749, 481009887, 587573945, 528153575, 560094623, 540119270, 37348913, 949686895, 795527831, 594244496, 351152626, 610756552, 120269380, 163383012, 314022366, 695481247, 725552300, 991913446, 732889032, 526360583, 553747624, 171293404, 961349798, 681146714, 947647065, 478946176, 914243491, 6421, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 988930000, 720804333, 77333122, 71478584, 802684893, 401413936, 252647494, 126498088, 436860660, 107501624, 604750710, 240569256, 974986253, 393455345, 927377743, 883926285, 725490027, 521497397, 43440187, 587245338, 458714971, 303019637, 164322731, 249451002, 358513673, 681348956, 451033021, 9243032, 772070369, 995255942, 736472255, 868092699, 47844500, 402409083, 179114254, 103854738, 46678400, 975293712, 970263719, 227914876, 351954049, 53574475, 546838129, 106382550, 115071819, 953092174, 478315368, 839263241, 725645322, 712617862, 494890866, 988367455, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 900006969, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 900006969, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 400006969, 809831282, 815548241, 358691851, 750590059, 713284541, 242757159, 135763073, 800021608, 963509516, 617674215, 969293784, 543338850, 815839627, 329448516, 715893385, 546356108, 416921673, 811412819, 328849343, 433639289, 675346056, 174270126, 820768601, 272567424, 614766610, 926369886, 872483144, 48081452, 432681564, 413915422, 662105764, 501705254, 138793308, 185469394, 180166149, 938114739, 466973496, 153808103, 526512203, 804554714, 944267973, 392374639, 842917453, 522394895, 436346971, 731892979, 642512104, 182859113, 454902339, 581768582, 324506047, 745918758, 897170174, 291468302, 977505750, 410568508, 772999686, 794321635, 651501887, 13705574, 584502763, 502268927, 124900578, 898499355, 295985307, 994672920, 144303481, 483827006, 479174491, 601463221, 449315155, 330964919, 414976947, 499819035, 187476700, 409345714, 963262468, 554461954, 310645478, 67661, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 300000000, 30030300, 300303003, 3030030, 30300303, 303003030, 30030300, 300303003, 3030030, 30300303, 303003030, 30030300, 300303003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 883622300, 669036119, 257383897, 331456055, 118354160, 973212098, 416973417, 946211525, 34594243, 378049694, 763505821, 662821050, 260614049, 474325353, 205921824, 137791970, 285519667, 52875193, 175072700, 655963181, 195226513, 168040379, 521765067, 568092616, 626968098, 581716135, 539546681, 728767378, 274895502, 67154633, 904763988, 171571554, 92723870, 967521185, 521690465, 446978893, 542837448, 569900378, 449749871, 641825348, 434944573, 4151211, 257502333, 350176088, 377226305, 724682903, 86738505, 259, 0, 0, 664000000, 384223576, 77655806, 268984277, 780855518, 712631072, 138232294, 75560405, 633173102, 447937331, 178093477, 735473623, 762909654, 921045167, 721115470, 118241925, 917412737, 880844525, 26813784, 562486098, 665936206, 396781083, 444444444, 251374444, 631433554, 209806566, 574570611, 969158830, 824815872, 812322502, 864428317, 697192749, 538976626, 445919938, 464135710, 949958051, 310266626, 291115780, 240001431, 226295236, 586757103, 132965817, 986975387, 50951661, 498234569, 142562459, 419584631, 928710596, 359565797, 152657460, 461226973, 768458971, 806567179, 288617868, 640884118, 904389073, 596236969, 423167529, 380552886, 758691524, 600776015, 666040080, 952913710, 648043789, 312329803, 93585288, 617508735, 741105041, 894446968, 849189884, 483140175, 184746334, 951426677, 5925686, 789847384, 608938721, 834748828, 539460124, 181872517, 375579811, 900880777, 43682854, 808557000, 656612977, 335726184, 954205271, 921294654, 644901719, 812362076, 493260187, 363741916, 944100391, 1536, 0, 0, 0, 0, 0, 0, 0, 62521150, 753424331, 300713482, 94569828, 592280290, 1006033, 577014246, 235920452, 371466402, 54856595, 860766560, 155851058, 794978558, 243852131, 154683303, 927434388, 234567899, 654321001, 456789987, 432100123, 678998765, 210012345, 899876543, 1234567, 987654321, 123456789, 765432100, 345678998, 543210012, 567899876, 321001234, 789987654, 100123456, 998765432, 12345678, 876543210, 234567899, 654321001, 456789987, 432100123, 678998765, 210012345, 899876543, 1234567, 987654321, 123456789, 765432100, 345678998, 543210012, 567899876, 321001234, 789987654, 100123456, 998765432, 12345678, 876543210, 234567899, 654321001, 456789987, 432100123, 134898765, 350620171, 356474814, 627};
	u_int in2[1] = {0};
	u_int out[1] = {0};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = malloc(sizeof(in1));
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = malloc(sizeof(in2));
	REQUIRE(tau->num1.num && tau->num2.num);
	memcpy(tau->num1.num, in1, sizeof(in1));
	memcpy(tau->num2.num, in2, sizeof(in2));

	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/******************** REVERSE OF PREVIOUS ********************/

TEST_F(large_multiplications, test_0_times_01ka)
{
	/* clang-format off */
	u_int in1[1] = {0};
	u_int in2[] = {131722372, 802671350, 132456030, 952390804, 989237724, 613862009, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 550000000, 555555555, 5555555, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 704686600, 493821814, 961286928, 322153716, 907156984, 310828945, 194896355, 611171487, 244518098, 231938737, 835448504, 923268737, 730202116, 743009913, 508000968, 332297803, 990517592, 742689628, 777775336, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 7, 0, 0, 770000000, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 777777777, 277777777, 542504068, 608548869, 501297955, 754021679, 672278000, 394108910, 160276848, 534685744, 968986731, 574146573, 779137604, 495207825, 840417941, 771396240, 727190624, 192915436, 903379804, 815966001, 11429967, 998134182, 658011715, 331591117, 191190811, 538876440, 751789571, 288215636, 653064708, 929084048, 487105239, 747561894, 205340763, 108049215, 943348769, 599175236, 146625093, 513882713, 448788052, 155250407, 757036788, 284348928, 863554107, 870895458, 845801636, 88076479, 511776237, 737629047, 248659873, 10007440, 446125514, 91977716, 635013656, 507882027, 55918320, 910057449, 432505528, 475929634, 210563623, 801688937, 808359103, 847048743, 751924511, 550199911, 414484903, 372540874, 76163220, 246365454, 797583759, 782313811, 908403698, 652790763, 216363355, 817270823, 430517238, 991857751, 509242050, 17653448, 208599291, 2, 0, 0, 0, 0, 0, 0, 38150020, 991025087, 964137894, 722553148, 386553725, 270998143, 214108149, 72979680, 699030993, 741108912, 769903271, 884494557, 344443410, 460990759, 604870008, 747411127, 763756622, 215455806, 947906002, 394543873, 66938617, 453291289, 343664471, 267707914, 12801657, 98078282, 517704826, 328152464, 372850297, 444460873, 733082616, 12135919, 445801394, 307632565, 233661314, 728930684, 786081362, 985690907, 21732050, 657593826, 893221339, 163500612, 978638373, 652309927, 199689309, 25989953, 338175286, 636839646, 197024354, 137856844, 452748236, 325125265, 867759428, 615066855, 38835627, 200200020, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 200200200, 633947200, 242821496, 675570901, 741469882, 452537907, 306752055, 117156467, 64790695, 936109148, 923919480, 71572279, 127780175, 541780674, 607024435, 151659015, 76280997, 900305055, 115947553, 721595598, 265638460, 746824605, 300469162, 298491605, 914173877, 67186749, 481009887, 587573945, 528153575, 560094623, 540119270, 37348913, 949686895, 795527831, 594244496, 351152626, 610756552, 120269380, 163383012, 314022366, 695481247, 725552300, 991913446, 732889032, 526360583, 553747624, 171293404, 961349798, 681146714, 947647065, 478946176, 914243491, 6421, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 988930000, 720804333, 77333122, 71478584, 802684893, 401413936, 252647494, 126498088, 436860660, 107501624, 604750710, 240569256, 974986253, 393455345, 927377743, 883926285, 725490027, 521497397, 43440187, 587245338, 458714971, 303019637, 164322731, 249451002, 358513673, 681348956, 451033021, 9243032, 772070369, 995255942, 736472255, 868092699, 47844500, 402409083, 179114254, 103854738, 46678400, 975293712, 970263719, 227914876, 351954049, 53574475, 546838129, 106382550, 115071819, 953092174, 478315368, 839263241, 725645322, 712617862, 494890866, 988367455, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 900006969, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 900006969, 690000696, 969000069, 696900006, 69690000, 6969000, 696900, 69690, 400006969, 809831282, 815548241, 358691851, 750590059, 713284541, 242757159, 135763073, 800021608, 963509516, 617674215, 969293784, 543338850, 815839627, 329448516, 715893385, 546356108, 416921673, 811412819, 328849343, 433639289, 675346056, 174270126, 820768601, 272567424, 614766610, 926369886, 872483144, 48081452, 432681564, 413915422, 662105764, 501705254, 138793308, 185469394, 180166149, 938114739, 466973496, 153808103, 526512203, 804554714, 944267973, 392374639, 842917453, 522394895, 436346971, 731892979, 642512104, 182859113, 454902339, 581768582, 324506047, 745918758, 897170174, 291468302, 977505750, 410568508, 772999686, 794321635, 651501887, 13705574, 584502763, 502268927, 124900578, 898499355, 295985307, 994672920, 144303481, 483827006, 479174491, 601463221, 449315155, 330964919, 414976947, 499819035, 187476700, 409345714, 963262468, 554461954, 310645478, 67661, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 300000000, 30030300, 300303003, 3030030, 30300303, 303003030, 30030300, 300303003, 3030030, 30300303, 303003030, 30030300, 300303003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 883622300, 669036119, 257383897, 331456055, 118354160, 973212098, 416973417, 946211525, 34594243, 378049694, 763505821, 662821050, 260614049, 474325353, 205921824, 137791970, 285519667, 52875193, 175072700, 655963181, 195226513, 168040379, 521765067, 568092616, 626968098, 581716135, 539546681, 728767378, 274895502, 67154633, 904763988, 171571554, 92723870, 967521185, 521690465, 446978893, 542837448, 569900378, 449749871, 641825348, 434944573, 4151211, 257502333, 350176088, 377226305, 724682903, 86738505, 259, 0, 0, 664000000, 384223576, 77655806, 268984277, 780855518, 712631072, 138232294, 75560405, 633173102, 447937331, 178093477, 735473623, 762909654, 921045167, 721115470, 118241925, 917412737, 880844525, 26813784, 562486098, 665936206, 396781083, 444444444, 251374444, 631433554, 209806566, 574570611, 969158830, 824815872, 812322502, 864428317, 697192749, 538976626, 445919938, 464135710, 949958051, 310266626, 291115780, 240001431, 226295236, 586757103, 132965817, 986975387, 50951661, 498234569, 142562459, 419584631, 928710596, 359565797, 152657460, 461226973, 768458971, 806567179, 288617868, 640884118, 904389073, 596236969, 423167529, 380552886, 758691524, 600776015, 666040080, 952913710, 648043789, 312329803, 93585288, 617508735, 741105041, 894446968, 849189884, 483140175, 184746334, 951426677, 5925686, 789847384, 608938721, 834748828, 539460124, 181872517, 375579811, 900880777, 43682854, 808557000, 656612977, 335726184, 954205271, 921294654, 644901719, 812362076, 493260187, 363741916, 944100391, 1536, 0, 0, 0, 0, 0, 0, 0, 62521150, 753424331, 300713482, 94569828, 592280290, 1006033, 577014246, 235920452, 371466402, 54856595, 860766560, 155851058, 794978558, 243852131, 154683303, 927434388, 234567899, 654321001, 456789987, 432100123, 678998765, 210012345, 899876543, 1234567, 987654321, 123456789, 765432100, 345678998, 543210012, 567899876, 321001234, 789987654, 100123456, 998765432, 12345678, 876543210, 234567899, 654321001, 456789987, 432100123, 678998765, 210012345, 899876543, 1234567, 987654321, 123456789, 765432100, 345678998, 543210012, 567899876, 321001234, 789987654, 100123456, 998765432, 12345678, 876543210, 234567899, 654321001, 456789987, 432100123, 134898765, 350620171, 356474814, 627};
	u_int out[1] = {0};
	/* clang-format on */

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = malloc(sizeof(in1));
	tau->num2.len = sizeof(in2) / sizeof(*in2);
	tau->num2.num = malloc(sizeof(in2));
	REQUIRE(tau->num1.num && tau->num2.num);
	memcpy(tau->num1.num, in1, sizeof(in1));
	memcpy(tau->num2.num, in2, sizeof(in2));

	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply(&(tau->num1), &(tau->num2));

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == false);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/* ################################################################### */
/* ###################### bi_multiply_int ############################ */
/* ################################################################### */

/* invalid_inputs */

TEST(invalid_inputs, test_null_times_0i)
{
	CHECK_PTR_EQ(bi_multiply_int(NULL, 0), NULL);
}

TEST(invalid_inputs, test_null_times_4490998i)
{
	CHECK_PTR_EQ(bi_multiply_int(NULL, 4490998), NULL);
}

TEST(invalid_inputs, test_null_times_neg4490998i)
{
	CHECK_PTR_EQ(bi_multiply_int(NULL, -4490998), NULL);
}

/* NaN */

TEST_F(invalid_inputs, test_NaN_times_0i)
{
	tau->output = bi_multiply_int(&tau->num1, 0);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_PTR_EQ(tau->output->num, NULL);
}

TEST_F(invalid_inputs, test_negNaN_times_0i)
{
	tau->num1.is_negative = true;
	tau->output = bi_multiply_int(&tau->num1, 0);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_PTR_EQ(tau->output->num, NULL);
}

TEST_F(invalid_inputs, test_NaN_times_4490998i)
{
	tau->output = bi_multiply_int(&tau->num1, 4490998);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_PTR_EQ(tau->output->num, NULL);
}

TEST_F(invalid_inputs, test_negNaN_times_4490998i)
{
	tau->num1.is_negative = true;
	tau->output = bi_multiply_int(&tau->num1, 4490998);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_PTR_EQ(tau->output->num, NULL);
}

TEST_F(invalid_inputs, test_NaN_times_neg4490998i)
{
	tau->output = bi_multiply_int(&tau->num1, -4490998);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_PTR_EQ(tau->output->num, NULL);
}

TEST_F(invalid_inputs, test_negNaN_times_neg4490998i)
{
	tau->num1.is_negative = true;
	tau->output = bi_multiply_int(&tau->num1, -4490998);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_PTR_EQ(tau->output->num, NULL);
}

/* simple_multiplications */

TEST_F(simple_multiplications, test_0_times_0i)
{
	u_int in1[1] = {0}, out[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply_int(&(tau->num1), 0);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_1_times_0i)
{
	u_int in1[1] = {1}, out[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply_int(&(tau->num1), 0);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_0_times_1i)
{
	u_int in1[1] = {0}, out[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply_int(&(tau->num1), 1);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_1_times_1i)
{
	u_int in1[1] = {1}, out[1] = {1};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply_int(&(tau->num1), 1);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_long_times_0i)
{
	u_int in1[] = {691273964, 472346283, 197812382, 3, 0, 938736};
	u_int out[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply_int(&(tau->num1), 0);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(simple_multiplications, test_0_times_intmaxi)
{
	u_int in1[1] = {0}, out[1] = {0};

	tau->num1.len = sizeof(in1) / sizeof(*in1);
	tau->num1.num = in1;
	tau->expected.len = sizeof(out) / sizeof(*out);
	tau->expected.num = out;
	tau->output = bi_multiply_int(&(tau->num1), INTMAX_MAX);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

/* negative_multiplications */

TEST_F(negative_multiplications, test_neg_o100f_times_4490998i)
{
	/* clang-format off */
	u_int in1[] = {0, 101000000, 555555555, 295555555, 9574, 0, 0, 684800000, 252449427, 2, 0, 94930300, 13103309, 99070958, 766};
	u_int out[] = {0, 798000000, 886847480, 408888888, 998142191, 42, 0, 430400000, 874833581, 10115745, 0, 787439400, 934938713, 474294930, 440549395, 3};
	/* clang-format on */

	tau->num1 = (bigint){
		.len = sizeof(in1) / sizeof(*in1),
		.is_negative = true,
		.num = in1,
	};
	tau->expected = (bigint){
		.len = sizeof(out) / sizeof(*out),
		.is_negative = true,
		.num = out,
	};
	tau->output = bi_multiply_int(&(tau->num1), 4490998);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(negative_multiplications, test__o100f_times_neg4490998i)
{
	/* clang-format off */
	u_int in1[] = {0, 101000000, 555555555, 295555555, 9574, 0, 0, 684800000, 252449427, 2, 0, 94930300, 13103309, 99070958, 766};
	u_int out[] = {0, 798000000, 886847480, 408888888, 998142191, 42, 0, 430400000, 874833581, 10115745, 0, 787439400, 934938713, 474294930, 440549395, 3};
	/* clang-format on */

	tau->num1 = (bigint){
		.len = sizeof(in1) / sizeof(*in1),
		.is_negative = false,
		.num = in1,
	};
	tau->expected = (bigint){
		.len = sizeof(out) / sizeof(*out),
		.is_negative = true,
		.num = out,
	};
	tau->output = bi_multiply_int(&(tau->num1), -4490998);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}

TEST_F(negative_multiplications, test_neg_o100f_times_neg4490998i)
{
	/* clang-format off */
	u_int in1[] = {0, 101000000, 555555555, 295555555, 9574, 0, 0, 684800000, 252449427, 2, 0, 94930300, 13103309, 99070958, 766};
	u_int out[] = {0, 798000000, 886847480, 408888888, 998142191, 42, 0, 430400000, 874833581, 10115745, 0, 787439400, 934938713, 474294930, 440549395, 3};
	/* clang-format on */

	tau->num1 = (bigint){
		.len = sizeof(in1) / sizeof(*in1),
		.is_negative = true,
		.num = in1,
	};
	tau->expected = (bigint){
		.len = sizeof(out) / sizeof(*out),
		.is_negative = false,
		.num = out,
	};
	tau->output = bi_multiply_int(&(tau->num1), -4490998);

	CHECK(tau->output->len == tau->expected.len);
	CHECK(tau->output->is_negative == tau->expected.is_negative);
	CHECK_BUF_EQ(
		tau->output->num, tau->expected.num,
		tau->expected.len * sizeof(*(tau->expected.num))
	);
}
